

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>utool.util_list &mdash; utool 1.1.2.dev1 documentation</title>















    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />





    <link rel="top" title="utool 1.1.2.dev1 documentation" href="../../index.html"/>
        <link rel="up" title="utool" href="../utool.html"/>


  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">


    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">



            <a href="../../index.html" class="icon icon-home"> utool



          </a>




              <div class="version">
                1.1.2.dev1
              </div>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">



                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../utool.html">utool package</a></li>
</ul>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">utool</a>
      </nav>



      <div class="wy-nav-content">
        <div class="rst-content">






<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>

          <li><a href="../index.html">Module code</a> &raquo;</li>

          <li><a href="../utool.html">utool</a> &raquo;</li>

    <li>utool.util_list</li>
      <li class="wy-breadcrumbs-aside">



      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <h1>Source code for utool.util_list</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">unicode_literals</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="nb">zip</span><span class="p">,</span> <span class="nb">map</span><span class="p">,</span> <span class="n">zip_longest</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="nb">reduce</span>
<span class="kn">from</span> <span class="nn">utool</span> <span class="kn">import</span> <span class="n">util_iter</span>
<span class="kn">from</span> <span class="nn">utool</span> <span class="kn">import</span> <span class="n">util_inject</span>
<span class="kn">from</span> <span class="nn">utool</span> <span class="kn">import</span> <span class="n">util_str</span>
<span class="kn">from</span> <span class="nn">utool</span> <span class="kn">import</span> <span class="n">util_type</span>
<span class="kn">from</span> <span class="nn">utool._internal.meta_util_six</span> <span class="kn">import</span> <span class="n">get_funcname</span><span class="p">,</span> <span class="n">set_funcname</span>
<span class="k">print</span><span class="p">,</span> <span class="n">rrr</span><span class="p">,</span> <span class="n">profile</span> <span class="o">=</span> <span class="n">util_inject</span><span class="o">.</span><span class="n">inject2</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="s">&#39;[list]&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">util_type</span><span class="o">.</span><span class="n">HAVE_NUMPY</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>


<span class="c"># --- List Allocations ---</span>


<div class="viewcode-block" id="lmap"><a class="viewcode-back" href="../../utool.html#utool.util_list.lmap">[docs]</a><span class="k">def</span> <span class="nf">lmap</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">iter_</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    list map - eagerly evaulates map like in python2</span>
<span class="sd">    (but you aren&#39;t using that right?)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">iter_</span><span class="p">]</span>
    <span class="c"># return list(map(func, iter_))</span>

</div>
<div class="viewcode-block" id="maplen"><a class="viewcode-back" href="../../utool.html#utool.util_list.maplen">[docs]</a><span class="k">def</span> <span class="nf">maplen</span><span class="p">(</span><span class="n">iter_</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">iter_</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="replace_nones"><a class="viewcode-back" href="../../utool.html#utool.util_list.replace_nones">[docs]</a><span class="k">def</span> <span class="nf">replace_nones</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">repl</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Recursively removes Nones in all lists and sublists and replaces them with</span>
<span class="sd">    the repl variable</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        repl (obj): replacement value</span>

<span class="sd">    Returns:</span>
<span class="sd">        list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-replace_nones</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; list_ = [None, 0, 1, 2]</span>
<span class="sd">        &gt;&gt;&gt; repl = -1</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; repl_list = replace_nones(list_, repl)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = str(repl_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [-1, 0, 1, 2]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">repl_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">repl</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="p">(</span>
            <span class="n">replace_nones</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">repl</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">item</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">repl_list</span>

</div>
<div class="viewcode-block" id="recursive_replace"><a class="viewcode-back" href="../../utool.html#utool.util_list.recursive_replace">[docs]</a><span class="k">def</span> <span class="nf">recursive_replace</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">repl</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Recursively removes target in all lists and sublists and replaces them with</span>
<span class="sd">    the repl variable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">repl_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">recursive_replace</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">repl</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="k">else</span>
        <span class="p">(</span><span class="n">repl</span> <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="n">target</span> <span class="k">else</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">repl_list</span>

</div>
<div class="viewcode-block" id="list_replace"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_replace">[docs]</a><span class="k">def</span> <span class="nf">list_replace</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">repl</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    alias</span>

<span class="sd">    Recursively removes target in all lists and sublists and replaces them with</span>
<span class="sd">    the repl variable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">recursive_replace</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">repl</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="alloc_lists"><a class="viewcode-back" href="../../utool.html#utool.util_list.alloc_lists">[docs]</a><span class="k">def</span> <span class="nf">alloc_lists</span><span class="p">(</span><span class="n">num_alloc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; allocates space for a ``list`` of lists &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_alloc</span><span class="p">)]</span>

</div>
<div class="viewcode-block" id="alloc_nones"><a class="viewcode-back" href="../../utool.html#utool.util_list.alloc_nones">[docs]</a><span class="k">def</span> <span class="nf">alloc_nones</span><span class="p">(</span><span class="n">num_alloc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; allocates space for a ``list`` of Nones &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_alloc</span>
    <span class="c">#return [None for _ in range(num_alloc)]</span>

</div>
<div class="viewcode-block" id="ensure_list_size"><a class="viewcode-back" href="../../utool.html#utool.util_list.ensure_list_size">[docs]</a><span class="k">def</span> <span class="nf">ensure_list_size</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">size_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Allocates more space if needbe.</span>

<span class="sd">    Ensures len(``list_``) == ``size_``.</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list): ``list`` to extend</span>
<span class="sd">        size_ (int): amount to exent by</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lendiff</span> <span class="o">=</span> <span class="p">(</span><span class="n">size_</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lendiff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lendiff</span><span class="p">)]</span>
        <span class="n">list_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>


<span class="c"># --- List Searching --- #</span>
</div>
<div class="viewcode-block" id="get_list_column_slice"><a class="viewcode-back" href="../../utool.html#utool.util_list.get_list_column_slice">[docs]</a><span class="k">def</span> <span class="nf">get_list_column_slice</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">util_iter</span><span class="o">.</span><span class="n">iget_list_column_slice</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">stride</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="get_list_column"><a class="viewcode-back" href="../../utool.html#utool.util_list.get_list_column">[docs]</a><span class="k">def</span> <span class="nf">get_list_column</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">colx</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    accepts a list of (indexables) and returns a list of indexables</span>
<span class="sd">    can also return a list of list of indexables if colx is a list</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list):  list of lists</span>
<span class="sd">        colx (int or list): index or key in each sublist get item</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: list of selected items</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-get_list_column</span>

<span class="sd">    Example0:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[&#39;a&#39;, &#39;b&#39;], [&#39;c&#39;, &#39;d&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; colx = 0</span>
<span class="sd">        &gt;&gt;&gt; result = get_list_column(list_, colx)</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(result, nl=False)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [&#39;a&#39;, &#39;c&#39;]</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[&#39;a&#39;, &#39;b&#39;], [&#39;c&#39;, &#39;d&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; colx = [1, 0]</span>
<span class="sd">        &gt;&gt;&gt; result = get_list_column(list_, colx)</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(result, nl=False)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[&#39;b&#39;, &#39;a&#39;], [&#39;d&#39;, &#39;c&#39;]]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [{&#39;spam&#39;: &#39;EGGS&#39;, &#39;ham&#39;: &#39;SPAM&#39;}, {&#39;spam&#39;: &#39;JAM&#39;, &#39;ham&#39;: &#39;PRAM&#39;},]</span>
<span class="sd">        &gt;&gt;&gt; # colx can be a key or list of keys as well</span>
<span class="sd">        &gt;&gt;&gt; colx = [&#39;spam&#39;]</span>
<span class="sd">        &gt;&gt;&gt; result = get_list_column(list_, colx)</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(result, nl=False)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[&#39;EGGS&#39;], [&#39;JAM&#39;]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">util_iter</span><span class="o">.</span><span class="n">iget_list_column</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">colx</span><span class="p">))</span>
    <span class="c">#if isinstance(colx, list):</span>
    <span class="c">#    # multi select</span>
    <span class="c">#    return [[row[colx_] for colx_ in colx] for row in list_]</span>
    <span class="c">#else:</span>
    <span class="c">#    return [row[colx] for row in list_]</span>

</div>
<span class="n">take_column</span> <span class="o">=</span> <span class="n">get_list_column</span>
<span class="c">#def get_list_row(list_, rowx):</span>
<span class="c">#    return list_[rowx]</span>


<div class="viewcode-block" id="safe_listget"><a class="viewcode-back" href="../../utool.html#utool.util_list.safe_listget">[docs]</a><span class="k">def</span> <span class="nf">safe_listget</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;?&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; depricate &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">default</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">list_</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">default</span>
    <span class="k">return</span> <span class="n">ret</span>

</div>
<div class="viewcode-block" id="listclip"><a class="viewcode-back" href="../../utool.html#utool.util_list.listclip">[docs]</a><span class="k">def</span> <span class="nf">listclip</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">fromback</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        num (int):</span>

<span class="sd">    Returns:</span>
<span class="sd">        sublist:</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-listclip</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; list_ = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; result_list = []</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; num = 3</span>
<span class="sd">        &gt;&gt;&gt; result_list += [ut.listclip(list_, num)]</span>
<span class="sd">        &gt;&gt;&gt; num = 9</span>
<span class="sd">        &gt;&gt;&gt; result_list += [ut.listclip(list_, num)]</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(result_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [</span>
<span class="sd">            [1, 2, 3],</span>
<span class="sd">            [1, 2, 3, 4, 5],</span>
<span class="sd">        ]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; list_ = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; result_list = []</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; num = 3</span>
<span class="sd">        &gt;&gt;&gt; result = ut.listclip(list_, num, fromback=True)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [3, 4, 5]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">),</span> <span class="n">num</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fromback</span><span class="p">:</span>
        <span class="n">sublist</span> <span class="o">=</span> <span class="n">list_</span><span class="p">[</span><span class="o">-</span><span class="n">num_</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sublist</span> <span class="o">=</span> <span class="n">list_</span><span class="p">[:</span><span class="n">num_</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">sublist</span>

</div>
<div class="viewcode-block" id="find_list_indexes"><a class="viewcode-back" href="../../utool.html#utool.util_list.find_list_indexes">[docs]</a><span class="k">def</span> <span class="nf">find_list_indexes</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">item_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list): list of items to be searched</span>
<span class="sd">        item_list (list): list of items to find</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="sd">        &gt;&gt;&gt; item_list = [&#39;d&#39;, &#39;c&#39;, &#39;b&#39;, &#39;f&#39;]</span>
<span class="sd">        &gt;&gt;&gt; index_list = find_list_indexes(list_, item_list)</span>
<span class="sd">        &gt;&gt;&gt; result = (&#39;index_list = %r&#39; % (index_list,))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        index_list = [None, 2, 1, None]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">listfind</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">item_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">index_list</span>

</div>
<div class="viewcode-block" id="listfind"><a class="viewcode-back" href="../../utool.html#utool.util_list.listfind">[docs]</a><span class="k">def</span> <span class="nf">listfind</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">tofind</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    get the position of item ``tofind`` in ``list_`` if it exists</span>
<span class="sd">    otherwise returns None</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (?):</span>
<span class="sd">        tofind (?):</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: index of ``tofind`` in ``list_``</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="sd">        &gt;&gt;&gt; tofind = &#39;b&#39;</span>
<span class="sd">        &gt;&gt;&gt; result = listfind(list_, tofind)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">list_</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">tofind</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

</div>
<div class="viewcode-block" id="search_list"><a class="viewcode-back" href="../../utool.html#utool.util_list.search_list">[docs]</a><span class="k">def</span> <span class="nf">search_list</span><span class="p">(</span><span class="n">text_list</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-search_list</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; text_list = [&#39;ham&#39;, &#39;jam&#39;, &#39;eggs&#39;, &#39;spam&#39;]</span>
<span class="sd">        &gt;&gt;&gt; pattern = &#39;.am&#39;</span>
<span class="sd">        &gt;&gt;&gt; flags = 0</span>
<span class="sd">        &gt;&gt;&gt; (valid_index_list, valid_match_list) = ut.search_list(text_list, pattern, flags)</span>
<span class="sd">        &gt;&gt;&gt; result = str(valid_index_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [0, 1, 3]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">re</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
    <span class="n">match_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">text_list</span><span class="p">]</span>
    <span class="n">valid_index_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">match_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">valid_match_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">match_list</span><span class="p">,</span> <span class="n">valid_index_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">valid_index_list</span><span class="p">,</span> <span class="n">valid_match_list</span>


<span class="c"># --- List Modification --- #</span>
</div>
<div class="viewcode-block" id="multi_replace"><a class="viewcode-back" href="../../utool.html#utool.util_list.multi_replace">[docs]</a><span class="k">def</span> <span class="nf">multi_replace</span><span class="p">(</span><span class="n">instr</span><span class="p">,</span> <span class="n">search_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">repl_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Does a string replace with a list of search and replacements</span>

<span class="sd">    TODO: rename</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">repl_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">search_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">repl_list</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">repl_list</span>
    <span class="k">for</span> <span class="n">ser</span><span class="p">,</span> <span class="n">repl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">search_list</span><span class="p">,</span> <span class="n">repl_list</span><span class="p">):</span>
        <span class="n">instr</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ser</span><span class="p">,</span> <span class="n">repl</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">instr</span>

</div>
<div class="viewcode-block" id="flatten"><a class="viewcode-back" href="../../utool.html#utool.util_list.flatten">[docs]</a><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list): list of lists</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: flat list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-flatten</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[&#39;a&#39;, &#39;b&#39;], [&#39;c&#39;, &#39;d&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; unflat_list2 = flatten(list_)</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(unflat_list2, nl=False)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">util_iter</span><span class="o">.</span><span class="n">iflatten</span><span class="p">(</span><span class="n">list_</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="invertible_flatten"><a class="viewcode-back" href="../../utool.html#utool.util_list.invertible_flatten">[docs]</a><span class="k">def</span> <span class="nf">invertible_flatten</span><span class="p">(</span><span class="n">unflat_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Flattens ``list`` but remember how to reconstruct the unflat ``list``</span>
<span class="sd">    Returns flat ``list`` and the unflat ``list`` with indexes into the flat</span>
<span class="sd">    ``list``</span>

<span class="sd">    Args:</span>
<span class="sd">        unflat_list (list): list of nested lists that we will flatten.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple : (flat_list, reverse_list)</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-invertible_flatten --show</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; unflat_list = [[1, 2, 3], [4, 5], [6, 6]]</span>
<span class="sd">        &gt;&gt;&gt; flat_list, reverse_list = invertible_flatten(unflat_list)</span>
<span class="sd">        &gt;&gt;&gt; result = (&#39;flat_list = %s\n&#39; % (ut.repr2(flat_list),))</span>
<span class="sd">        &gt;&gt;&gt; result += (&#39;reverse_list = %s&#39; % (ut.repr2(reverse_list),))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        flat_list = [1, 2, 3, 4, 5, 6, 6]</span>
<span class="sd">        reverse_list = [[0, 1, 2], [3, 4], [5, 6]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># def nextnum(trick_=[0]):</span>
    <span class="c">#     num = trick_[0]</span>
    <span class="c">#     trick_[0] += 1</span>
    <span class="c">#     return num</span>
    <span class="n">nextnum</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">six</span><span class="o">.</span><span class="n">next</span><span class="p">,</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="c"># Build an unflat list of flat indexes</span>
    <span class="n">reverse_list</span> <span class="o">=</span> <span class="p">[[</span><span class="n">nextnum</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tup</span><span class="p">]</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">unflat_list</span><span class="p">]</span>
    <span class="n">flat_list</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">unflat_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flat_list</span><span class="p">,</span> <span class="n">reverse_list</span>

</div>
<span class="nd">@profile</span>
<div class="viewcode-block" id="unflatten"><a class="viewcode-back" href="../../utool.html#utool.util_list.unflatten">[docs]</a><span class="k">def</span> <span class="nf">unflatten</span><span class="p">(</span><span class="n">flat_list</span><span class="p">,</span> <span class="n">reverse_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Rebuilds unflat list from invertible_flatten</span>

<span class="sd">    Args:</span>
<span class="sd">        flat_list (list): the flattened list</span>
<span class="sd">        reverse_list (list): the list which undoes flattenting</span>

<span class="sd">    Returns:</span>
<span class="sd">        unflat_list2: original nested list</span>


<span class="sd">    SeeAlso:</span>
<span class="sd">        invertible_flatten</span>
<span class="sd">        invertible_flatten2</span>
<span class="sd">        unflatten2</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unflat_list2</span> <span class="o">=</span> <span class="p">[[</span><span class="n">flat_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">tup</span><span class="p">]</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">reverse_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">unflat_list2</span>

</div>
<span class="nd">@profile</span>
<div class="viewcode-block" id="accumulate"><a class="viewcode-back" href="../../utool.html#utool.util_list.accumulate">[docs]</a><span class="k">def</span> <span class="nf">accumulate</span><span class="p">(</span><span class="n">iterator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Notice:</span>
<span class="sd">        use itertools.accumulate in python &gt; 3.2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">item</span>
        <span class="k">yield</span> <span class="n">total</span>

</div>
<span class="nd">@profile</span>
<div class="viewcode-block" id="invertible_flatten2"><a class="viewcode-back" href="../../utool.html#utool.util_list.invertible_flatten2">[docs]</a><span class="k">def</span> <span class="nf">invertible_flatten2</span><span class="p">(</span><span class="n">unflat_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An alternative to invertible_flatten which uses cumsum</span>

<span class="sd">    Flattens ``list`` but remember how to reconstruct the unflat ``list``</span>
<span class="sd">    Returns flat ``list`` and the unflat ``list`` with indexes into the flat</span>
<span class="sd">    ``list``</span>

<span class="sd">    Args:</span>
<span class="sd">        unflat_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: flat_list, cumlen_list</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool</span>
<span class="sd">        &gt;&gt;&gt; utool.util_list</span>
<span class="sd">        &gt;&gt;&gt; unflat_list = [[5], [2, 3, 12, 3, 3], [9], [13, 3], [5]]</span>
<span class="sd">        &gt;&gt;&gt; flat_list, cumlen_list = invertible_flatten2(unflat_list)</span>
<span class="sd">        &gt;&gt;&gt; unflat_list2 = unflatten2(flat_list, cumlen_list)</span>
<span class="sd">        &gt;&gt;&gt; assert unflat_list2 == unflat_list</span>
<span class="sd">        &gt;&gt;&gt; result = ((flat_list, cumlen_list))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        ([5, 2, 3, 12, 3, 3, 9, 13, 3, 5], [1, 6, 7, 9, 10])</span>

<span class="sd">    TODO: This flatten is faster fix it to be used everywhere</span>

<span class="sd">    Timeit:</span>
<span class="sd">        unflat_list = [[random.random() for _ in range(int(random.random() * 1000))] for __ in range(200)]</span>
<span class="sd">        unflat_arrs = list(map(np.array, unflat_list))</span>

<span class="sd">        %timeit invertible_flatten2(unflat_list)</span>
<span class="sd">        %timeit invertible_flatten2_numpy(unflat_list)</span>
<span class="sd">        %timeit invertible_flatten2_numpy(unflat_arrs)</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        invertible_flatten</span>
<span class="sd">        unflatten</span>
<span class="sd">        unflatten2</span>

<span class="sd">    Timeits:</span>
<span class="sd">        import utool</span>
<span class="sd">        unflat_list = aids_list1</span>
<span class="sd">        flat_aids1, reverse_list = utool.invertible_flatten(unflat_list)</span>
<span class="sd">        flat_aids2, cumlen_list = utool.invertible_flatten2(unflat_list)</span>
<span class="sd">        unflat_list1 = utool.unflatten(flat_aids1, reverse_list)</span>
<span class="sd">        unflat_list2 = utool.unflatten2(flat_aids2, cumlen_list)</span>
<span class="sd">        assert list(map(list, unflat_list1)) == unflat_list2</span>
<span class="sd">        print(utool.get_object_size_str(unflat_list,  &#39;unflat_list  &#39;))</span>
<span class="sd">        print(utool.get_object_size_str(flat_aids1,   &#39;flat_aids1   &#39;))</span>
<span class="sd">        print(utool.get_object_size_str(flat_aids2,   &#39;flat_aids2   &#39;))</span>
<span class="sd">        print(utool.get_object_size_str(reverse_list, &#39;reverse_list &#39;))</span>
<span class="sd">        print(utool.get_object_size_str(cumlen_list,  &#39;cumlen_list  &#39;))</span>
<span class="sd">        print(utool.get_object_size_str(unflat_list1, &#39;unflat_list1 &#39;))</span>
<span class="sd">        print(utool.get_object_size_str(unflat_list2, &#39;unflat_list2 &#39;))</span>
<span class="sd">        print(&#39;Timings 1:)</span>
<span class="sd">        %timeit utool.invertible_flatten(unflat_list)</span>
<span class="sd">        %timeit utool.unflatten(flat_aids1, reverse_list)</span>
<span class="sd">        print(&#39;Timings 2:)</span>
<span class="sd">        %timeit utool.invertible_flatten2(unflat_list)</span>
<span class="sd">        %timeit utool.unflatten2(flat_aids2, cumlen_list)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sublen_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">unflat_list</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">util_type</span><span class="o">.</span><span class="n">HAVE_NUMPY</span><span class="p">:</span>
        <span class="n">cumlen_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sublen_list</span><span class="p">)</span>
        <span class="c"># Build an unflat list of flat indexes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cumlen_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">accumulate</span><span class="p">(</span><span class="n">sublen_list</span><span class="p">))</span>
    <span class="n">flat_list</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">unflat_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flat_list</span><span class="p">,</span> <span class="n">cumlen_list</span>

</div>
<span class="nd">@profile</span>
<div class="viewcode-block" id="invertible_flatten2_numpy"><a class="viewcode-back" href="../../utool.html#utool.util_list.invertible_flatten2_numpy">[docs]</a><span class="k">def</span> <span class="nf">invertible_flatten2_numpy</span><span class="p">(</span><span class="n">unflat_arrs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; more numpy version</span>

<span class="sd">    TODO: move to vtool</span>

<span class="sd">    Args:</span>
<span class="sd">        unflat_arrs (list):  list of ndarrays</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: (flat_list, cumlen_list)</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-invertible_flatten2_numpy</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTET</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; unflat_arrs = [np.array([1, 2, 1]), np.array([5, 9]), np.array([4])]</span>
<span class="sd">        &gt;&gt;&gt; (flat_list, cumlen_list) = invertible_flatten2_numpy(unflat_arrs)</span>
<span class="sd">        &gt;&gt;&gt; result = str((flat_list, cumlen_list))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        (array([1, 2, 1, 5, 9, 4]), array([3, 5, 6]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cumlen_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">([</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">unflat_arrs</span><span class="p">])</span>
    <span class="n">flat_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">unflat_arrs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flat_list</span><span class="p">,</span> <span class="n">cumlen_list</span>

</div>
<div class="viewcode-block" id="unflatten2"><a class="viewcode-back" href="../../utool.html#utool.util_list.unflatten2">[docs]</a><span class="k">def</span> <span class="nf">unflatten2</span><span class="p">(</span><span class="n">flat_list</span><span class="p">,</span> <span class="n">cumlen_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Rebuilds unflat list from invertible_flatten</span>

<span class="sd">    Args:</span>
<span class="sd">        flat_list (list): the flattened list</span>
<span class="sd">        cumlen_list (list): the list which undoes flattenting</span>

<span class="sd">    Returns:</span>
<span class="sd">        unflat_list2: original nested list</span>


<span class="sd">    SeeAlso:</span>
<span class="sd">        invertible_flatten</span>
<span class="sd">        invertible_flatten2</span>
<span class="sd">        unflatten2</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool</span>
<span class="sd">        &gt;&gt;&gt; utool.util_list</span>
<span class="sd">        &gt;&gt;&gt; flat_list = [5, 2, 3, 12, 3, 3, 9, 13, 3, 5]</span>
<span class="sd">        &gt;&gt;&gt; cumlen_list = [ 1,  6,  7,  9, 10]</span>
<span class="sd">        &gt;&gt;&gt; unflat_list2 = unflatten2(flat_list, cumlen_list)</span>
<span class="sd">        &gt;&gt;&gt; result = (unflat_list2)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[5], [2, 3, 12, 3, 3], [9], [13, 3], [5]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unflat_list2</span> <span class="o">=</span> <span class="p">[</span><span class="n">flat_list</span><span class="p">[</span><span class="n">low</span><span class="p">:</span><span class="n">high</span><span class="p">]</span> <span class="k">for</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="ow">in</span>
                    <span class="nb">zip</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">cumlen_list</span><span class="p">),</span> <span class="n">cumlen_list</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">unflat_list2</span>

</div>
<span class="nd">@profile</span>
<div class="viewcode-block" id="unflat_unique_rowid_map"><a class="viewcode-back" href="../../utool.html#utool.util_list.unflat_unique_rowid_map">[docs]</a><span class="k">def</span> <span class="nf">unflat_unique_rowid_map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">unflat_rowids</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    performs only one call to the underlying func with unique rowids the func</span>
<span class="sd">    must be some lookup function</span>

<span class="sd">    TODO: move this to a better place.</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-unflat_unique_rowid_map:0</span>
<span class="sd">        python -m utool.util_list --test-unflat_unique_rowid_map:1</span>

<span class="sd">    Example0:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; kwargs = {}</span>
<span class="sd">        &gt;&gt;&gt; unflat_rowids = [[1, 2, 3], [2, 5], [1], []]</span>
<span class="sd">        &gt;&gt;&gt; num_calls0 = [0]</span>
<span class="sd">        &gt;&gt;&gt; num_input0 = [0]</span>
<span class="sd">        &gt;&gt;&gt; def func0(rowids, num_calls0=num_calls0, num_input0=num_input0):</span>
<span class="sd">        ...    num_calls0[0] += 1</span>
<span class="sd">        ...    num_input0[0] += len(rowids)</span>
<span class="sd">        ...    return [rowid + 10 for rowid in rowids]</span>
<span class="sd">        &gt;&gt;&gt; func = func0</span>
<span class="sd">        &gt;&gt;&gt; unflat_vals = unflat_unique_rowid_map(func, unflat_rowids, **kwargs)</span>
<span class="sd">        &gt;&gt;&gt; result = [arr.tolist() for arr in unflat_vals]</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(num_calls0[0], 1)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(num_input0[0], 4)</span>
<span class="sd">        [[11, 12, 13], [12, 15], [11], []]</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; kwargs = {}</span>
<span class="sd">        &gt;&gt;&gt; unflat_rowids = [[1, 2, 3], [2, 5], [1], []]</span>
<span class="sd">        &gt;&gt;&gt; num_calls1 = [0]</span>
<span class="sd">        &gt;&gt;&gt; num_input1 = [0]</span>
<span class="sd">        &gt;&gt;&gt; def func1(rowids, num_calls1=num_calls1, num_input1=num_input1, np=np):</span>
<span class="sd">        ...    num_calls1[0] += 1</span>
<span class="sd">        ...    num_input1[0] += len(rowids)</span>
<span class="sd">        ...    return [np.array([rowid + 10, rowid, 3]) for rowid in rowids]</span>
<span class="sd">        &gt;&gt;&gt; func = func1</span>
<span class="sd">        &gt;&gt;&gt; unflat_vals = unflat_unique_rowid_map(func, unflat_rowids, **kwargs)</span>
<span class="sd">        &gt;&gt;&gt; result = [arr.tolist() for arr in unflat_vals]</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(num_calls1[0], 1)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(num_input1[0], 4)</span>
<span class="sd">        [[[11, 1, 3], [12, 2, 3], [13, 3, 3]], [[12, 2, 3], [15, 5, 3]], [[11, 1, 3]], []]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
    <span class="c"># First flatten the list, and remember the original dimensions</span>
    <span class="n">flat_rowids</span><span class="p">,</span> <span class="n">reverse_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">invertible_flatten2</span><span class="p">(</span><span class="n">unflat_rowids</span><span class="p">)</span>
    <span class="c"># Then make the input unique</span>
    <span class="n">flat_rowids_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">flat_rowids</span><span class="p">)</span>
    <span class="n">unique_flat_rowids</span><span class="p">,</span> <span class="n">inverse_unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">flat_rowids_arr</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="c"># Then preform the lookup / implicit mapping</span>
    <span class="n">unique_flat_vals</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">unique_flat_rowids</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c"># Then broadcast unique values back to original flat positions</span>
    <span class="n">flat_vals_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">unique_flat_vals</span><span class="p">)[</span><span class="n">inverse_unique</span><span class="p">]</span>
    <span class="c">#flat_vals_ = np.array(unique_flat_vals).take(inverse_unique, axis=0)</span>
    <span class="n">output_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">flat_rowids_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">flat_vals_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
    <span class="n">flat_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">flat_vals_</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">output_shape</span><span class="p">)</span>
    <span class="c"># Then _unflatten the results to the original input dimensions</span>
    <span class="n">unflat_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">unflatten2</span><span class="p">(</span><span class="n">flat_vals</span><span class="p">,</span> <span class="n">reverse_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unflat_vals</span>

</div>
<div class="viewcode-block" id="tuplize"><a class="viewcode-back" href="../../utool.html#utool.util_list.tuplize">[docs]</a><span class="k">def</span> <span class="nf">tuplize</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Converts each scalar item in a list to a dimension-1 tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tup_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">if</span> <span class="n">util_iter</span><span class="o">.</span><span class="n">isiterable</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">item</span><span class="p">,)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">tup_list</span>

</div>
<div class="viewcode-block" id="flattenize"><a class="viewcode-back" href="../../utool.html#utool.util_list.flattenize">[docs]</a><span class="k">def</span> <span class="nf">flattenize</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; maps flatten to a tuplized list</span>

<span class="sd">    Weird function. DEPRICATE</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[1, 2, 3], [2, 3, [4, 2, 1]], [3, 2], [[1, 2], [3, 4]]]</span>
<span class="sd">        &gt;&gt;&gt; import utool</span>
<span class="sd">        &gt;&gt;&gt; from itertools import zip</span>
<span class="sd">        &gt;&gt;&gt; val_list1 = [(1, 2), (2, 4), (5, 3)]</span>
<span class="sd">        &gt;&gt;&gt; id_list1  = [(1,),     (2,),   (3,)]</span>
<span class="sd">        &gt;&gt;&gt; out_list1 = utool.flattenize(zip(val_list1, id_list1))</span>

<span class="sd">        &gt;&gt;&gt; val_list2 = [1, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; id_list2  = [(1,),     (2,),   (3,)]</span>
<span class="sd">        &gt;&gt;&gt; out_list2 = utool.flattenize(zip(val_list2, id_list2))</span>

<span class="sd">        &gt;&gt;&gt; val_list3 = [1, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; id_list3  = [1, 2, 3]</span>
<span class="sd">        &gt;&gt;&gt; out_list3 = utool.flattenize(zip(val_list3, id_list3))</span>

<span class="sd">        out_list4 = list(zip(val_list3, id_list3))</span>
<span class="sd">        %timeit utool.flattenize(zip(val_list1, id_list1))</span>
<span class="sd">        %timeit utool.flattenize(zip(val_list2, id_list2))</span>
<span class="sd">        %timeit utool.flattenize(zip(val_list3, id_list3))</span>
<span class="sd">        %timeit list(zip(val_list3, id_list3))</span>

<span class="sd">        100000 loops, best of 3: 14 us per loop</span>
<span class="sd">        100000 loops, best of 3: 16.5 us per loop</span>
<span class="sd">        100000 loops, best of 3: 18 us per loop</span>
<span class="sd">        1000000 loops, best of 3: 1.18 us per loop</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#return map(iflatten, list_)</span>
    <span class="c">#if not isiterable(list_):</span>
    <span class="c">#    list2_ = (list_,)</span>
    <span class="c">#else:</span>
    <span class="c">#    list2_ = list_</span>
    <span class="n">tuplized_iter</span>   <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">tuplize</span><span class="p">,</span> <span class="n">list_</span><span class="p">))</span>
    <span class="n">flatenized_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">flatten</span><span class="p">,</span> <span class="n">tuplized_iter</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">flatenized_list</span>

</div>
<div class="viewcode-block" id="safe_slice"><a class="viewcode-back" href="../../utool.html#utool.util_list.safe_slice">[docs]</a><span class="k">def</span> <span class="nf">safe_slice</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; safe_slice(list_, [start], stop, [end], [step])</span>
<span class="sd">        Slices list and truncates if out of bounds</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">stop</span>  <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">step</span>  <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">stop</span>  <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">len_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">stop</span> <span class="o">&gt;</span> <span class="n">len_</span><span class="p">:</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">len_</span>
    <span class="k">return</span> <span class="n">list_</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)]</span>


<span class="c"># --- List Queries --- #</span>

</div>
<div class="viewcode-block" id="allsame"><a class="viewcode-back" href="../../utool.html#utool.util_list.allsame">[docs]</a><span class="k">def</span> <span class="nf">allsame</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    checks to see if list is equal everywhere</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if all items in the list are equal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="n">first_item</span> <span class="o">=</span> <span class="n">list_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">list_all_eq_to</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">first_item</span><span class="p">,</span> <span class="n">strict</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="list_all_eq_to"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_all_eq_to">[docs]</a><span class="k">def</span> <span class="nf">list_all_eq_to</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    checks to see if list is equal everywhere to a value</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        val : value to check against</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if all items in the list are equal to val</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">util_type</span><span class="o">.</span><span class="n">HAVE_NUMPY</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="n">item</span> <span class="o">==</span> <span class="n">val</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">strict</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">all</span><span class="p">([</span><span class="nb">repr</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">repr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span>

</div>
<div class="viewcode-block" id="get_dirty_items"><a class="viewcode-back" href="../../utool.html#utool.util_list.get_dirty_items">[docs]</a><span class="k">def</span> <span class="nf">get_dirty_items</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns each item in item_list where not flag in flag_list</span>

<span class="sd">    Args:</span>
<span class="sd">        item_list (list):</span>
<span class="sd">        flag_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        dirty_items</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">item_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag_list</span><span class="p">)</span>
    <span class="n">dirty_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span> <span class="ow">in</span>
                   <span class="nb">zip</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>
                   <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">]</span>
    <span class="c">#print(&#39;num_dirty_items = %r&#39; % len(dirty_items))</span>
    <span class="c">#print(&#39;item_list = %r&#39; % (item_list,))</span>
    <span class="c">#print(&#39;flag_list = %r&#39; % (flag_list,))</span>
    <span class="k">return</span> <span class="n">dirty_items</span>

</div>
<div class="viewcode-block" id="compress"><a class="viewcode-back" href="../../utool.html#utool.util_list.compress">[docs]</a><span class="k">def</span> <span class="nf">compress</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    like np.compress but for lists</span>

<span class="sd">    Returns items in item list where the corresponding item in flag list is</span>
<span class="sd">    True</span>

<span class="sd">    Args:</span>
<span class="sd">        item_list (list): list of items to mask</span>
<span class="sd">        flag_list (list): list of booleans used as a mask</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : filtered_items - masked items</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">item_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag_list</span><span class="p">),</span> <span class="p">(</span>
        <span class="s">&#39;lists should correspond. len(item_list)=</span><span class="si">%r</span><span class="s"> len(flag_list)=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span>
        <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag_list</span><span class="p">)))</span>
    <span class="n">filtered_items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">util_iter</span><span class="o">.</span><span class="n">iter_compress</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">filtered_items</span>

</div>
<div class="viewcode-block" id="ziptake"><a class="viewcode-back" href="../../utool.html#utool.util_list.ziptake">[docs]</a><span class="k">def</span> <span class="nf">ziptake</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">indexes_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SeeAlso:</span>
<span class="sd">        vt.ziptake</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">take</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">index_list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">list_</span><span class="p">,</span> <span class="n">index_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">indexes_list</span><span class="p">)]</span>

</div>
<div class="viewcode-block" id="zipcompress"><a class="viewcode-back" href="../../utool.html#utool.util_list.zipcompress">[docs]</a><span class="k">def</span> <span class="nf">zipcompress</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">flags_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SeeAlso:</span>
<span class="sd">        vt.zipcompress</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">compress</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">list_</span><span class="p">,</span> <span class="n">flags</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">flags_list</span><span class="p">)]</span>

</div>
<div class="viewcode-block" id="list_zipflatten"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_zipflatten">[docs]</a><span class="k">def</span> <span class="nf">list_zipflatten</span><span class="p">(</span><span class="o">*</span><span class="n">items_lists</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">flatten</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">items_lists</span><span class="p">)]</span>

</div>
<div class="viewcode-block" id="list_compresstake"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_compresstake">[docs]</a><span class="k">def</span> <span class="nf">list_compresstake</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">flags_list</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">compress</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span> <span class="k">for</span> <span class="n">list_</span><span class="p">,</span> <span class="n">flags</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">flags_list</span><span class="p">)]</span>

</div>
<div class="viewcode-block" id="filter_items"><a class="viewcode-back" href="../../utool.html#utool.util_list.filter_items">[docs]</a><span class="k">def</span> <span class="nf">filter_items</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns items in item list where the corresponding item in flag list is True</span>

<span class="sd">    Args:</span>
<span class="sd">        item_list (list):</span>
<span class="sd">        flag_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        filtered_items</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        util_iter.iter_compress</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">compress</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="filterfalse_items"><a class="viewcode-back" href="../../utool.html#utool.util_list.filterfalse_items">[docs]</a><span class="k">def</span> <span class="nf">filterfalse_items</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns items in item list where the corresponding item in flag list is true</span>

<span class="sd">    Args:</span>
<span class="sd">        item_list (list): list of items</span>
<span class="sd">        flag_list (list): list of truthy values</span>

<span class="sd">    Returns:</span>
<span class="sd">        filtered_items : items where the corresponding flag was truthy</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        util_iter.ifilterfalse_items</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">item_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag_list</span><span class="p">)</span>
    <span class="n">filtered_items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">util_iter</span><span class="o">.</span><span class="n">ifilterfalse_items</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">filtered_items</span>

</div>
<div class="viewcode-block" id="filter_Nones"><a class="viewcode-back" href="../../utool.html#utool.util_list.filter_Nones">[docs]</a><span class="k">def</span> <span class="nf">filter_Nones</span><span class="p">(</span><span class="n">item_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes any nones from the list</span>

<span class="sd">    Args:</span>
<span class="sd">        item_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        sublist which does not contain Nones</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">util_iter</span><span class="o">.</span><span class="n">ifilter_Nones</span><span class="p">(</span><span class="n">item_list</span><span class="p">))</span>


<span class="c"># --- List combinations --- #</span>

</div>
<div class="viewcode-block" id="intersect_ordered"><a class="viewcode-back" href="../../utool.html#utool.util_list.intersect_ordered">[docs]</a><span class="k">def</span> <span class="nf">intersect_ordered</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns list1 elements that are also in list2. preserves order of list1</span>

<span class="sd">    intersect_ordered</span>

<span class="sd">    Args:</span>
<span class="sd">        list1 (list):</span>
<span class="sd">        list2 (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: new_list</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list1 = [&#39;featweight_rowid&#39;, &#39;feature_rowid&#39;, &#39;config_rowid&#39;, &#39;featweight_forground_weight&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list2 = [u&#39;featweight_rowid&#39;]</span>
<span class="sd">        &gt;&gt;&gt; result = intersect_ordered(list1, list2)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [&#39;featweight_rowid&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list1</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">)]</span>

</div>
<div class="viewcode-block" id="list_intersection"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_intersection">[docs]</a><span class="k">def</span> <span class="nf">list_intersection</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="list_issubset"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_issubset">[docs]</a><span class="k">def</span> <span class="nf">list_issubset</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="list_issuperset"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_issuperset">[docs]</a><span class="k">def</span> <span class="nf">list_issuperset</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">))</span>

</div>
<span class="n">issubset</span> <span class="o">=</span> <span class="n">list_issubset</span>
<span class="n">is_subset</span> <span class="o">=</span> <span class="n">list_issubset</span>
<span class="n">is_superset</span> <span class="o">=</span> <span class="n">list_issuperset</span>
<span class="n">issuperset</span> <span class="o">=</span> <span class="n">list_issuperset</span>


<div class="viewcode-block" id="list_set_equal"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_set_equal">[docs]</a><span class="k">def</span> <span class="nf">list_set_equal</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="is_subset_of_any"><a class="viewcode-back" href="../../utool.html#utool.util_list.is_subset_of_any">[docs]</a><span class="k">def</span> <span class="nf">is_subset_of_any</span><span class="p">(</span><span class="n">set_</span><span class="p">,</span> <span class="n">other_sets</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns True if set_ is a subset of any set in other_sets</span>

<span class="sd">    Args:</span>
<span class="sd">        set_ (set):</span>
<span class="sd">        other_sets (list of sets):</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: flag</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-is_subset_of_any</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; set_ = {1, 2}</span>
<span class="sd">        &gt;&gt;&gt; other_sets = [{1, 4}, {3, 2, 1}]</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; result = is_subset_of_any(set_, other_sets)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        True</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; set_ = {1, 2}</span>
<span class="sd">        &gt;&gt;&gt; other_sets = [{1, 4}, {3, 2}]</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; result = is_subset_of_any(set_, other_sets)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">set_</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">set_</span><span class="p">)</span>
    <span class="n">other_sets</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="n">other_sets</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">([</span><span class="n">set_</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">other_set</span><span class="p">)</span> <span class="k">for</span> <span class="n">other_set</span> <span class="ow">in</span> <span class="n">other_sets</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="priority_sort"><a class="viewcode-back" href="../../utool.html#utool.util_list.priority_sort">[docs]</a><span class="k">def</span> <span class="nf">priority_sort</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">priority</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        priority (list): desired order of items</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: reordered_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-priority_argsort</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [2, 4, 6, 8, 10]</span>
<span class="sd">        &gt;&gt;&gt; priority = [8, 2, 6, 9]</span>
<span class="sd">        &gt;&gt;&gt; reordered_list = priority_sort(list_, priority)</span>
<span class="sd">        &gt;&gt;&gt; result = str(reordered_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [8, 2, 6, 4, 10]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># remove requested priority items not in the list</span>
    <span class="n">priority_</span> <span class="o">=</span> <span class="n">setintersect_ordered</span><span class="p">(</span><span class="n">priority</span><span class="p">,</span> <span class="n">list_</span><span class="p">)</span>
    <span class="n">reordered_list</span> <span class="o">=</span> <span class="n">unique_ordered</span><span class="p">(</span><span class="n">priority_</span> <span class="o">+</span> <span class="n">list_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">reordered_list</span>

</div>
<div class="viewcode-block" id="priority_argsort"><a class="viewcode-back" href="../../utool.html#utool.util_list.priority_argsort">[docs]</a><span class="k">def</span> <span class="nf">priority_argsort</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">priority</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        priority (list): desired order of items</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: reordered_index_list</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; list_ = [2, 4, 6, 8, 10]</span>
<span class="sd">        &gt;&gt;&gt; priority = [8, 2, 6, 9]</span>
<span class="sd">        &gt;&gt;&gt; sortx = priority_argsort(list_, priority)</span>
<span class="sd">        &gt;&gt;&gt; reordered_list = priority_sort(list_, priority)</span>
<span class="sd">        &gt;&gt;&gt; assert ut.take(list_, sortx) == reordered_list</span>
<span class="sd">        &gt;&gt;&gt; result = str(sortx)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [3, 0, 2, 1, 4]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reordered_list</span> <span class="o">=</span> <span class="n">priority_sort</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">priority</span><span class="p">)</span>
    <span class="c"># FIXME: inefficient</span>
    <span class="n">sortx</span> <span class="o">=</span> <span class="p">[</span><span class="n">list_</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">reordered_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">sortx</span>

</div>
<div class="viewcode-block" id="flag_unique_items"><a class="viewcode-back" href="../../utool.html#utool.util_list.flag_unique_items">[docs]</a><span class="k">def</span> <span class="nf">flag_unique_items</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of flags corresponding to the first time an item is seen</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list): list of items</span>

<span class="sd">    Returns:</span>
<span class="sd">        flag_list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">unseen</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="n">flag_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">unseen</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">flag_list</span>

</div>
<div class="viewcode-block" id="iflag_unique_items"><a class="viewcode-back" href="../../utool.html#utool.util_list.iflag_unique_items">[docs]</a><span class="k">def</span> <span class="nf">iflag_unique_items</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of flags corresponding to the first time an item is seen</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list): list of items</span>

<span class="sd">    Returns:</span>
<span class="sd">        flag_iter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">unseen</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="n">flag_iter</span> <span class="o">=</span> <span class="p">(</span><span class="n">unseen</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flag_iter</span>

</div>
<div class="viewcode-block" id="unique_ordered"><a class="viewcode-back" href="../../utool.html#utool.util_list.unique_ordered">[docs]</a><span class="k">def</span> <span class="nf">unique_ordered</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns unique items in ``list_`` in the order they were seen.</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: unique_list - unique list which maintains order</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-unique_ordered</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [4, 6, 6, 0, 6, 1, 0, 2, 2, 1]</span>
<span class="sd">        &gt;&gt;&gt; unique_list = unique_ordered(list_)</span>
<span class="sd">        &gt;&gt;&gt; result = (&#39;unique_list = %s&#39; % (str(unique_list),))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        unique_list = [4, 6, 0, 1, 2]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flag_list</span> <span class="o">=</span> <span class="n">flag_unique_items</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>
    <span class="n">unique_list</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unique_list</span>

</div>
<div class="viewcode-block" id="unique_unordered"><a class="viewcode-back" href="../../utool.html#utool.util_list.unique_unordered">[docs]</a><span class="k">def</span> <span class="nf">unique_unordered</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    wrapper around list(set(list_))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list_</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="unique"><a class="viewcode-back" href="../../utool.html#utool.util_list.unique">[docs]</a><span class="k">def</span> <span class="nf">unique</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns unique items in ``list_``.</span>
<span class="sd">    Generally, unordered (*should be) faster.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ordered</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">unique_ordered</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">unique_unordered</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="flat_unique"><a class="viewcode-back" href="../../utool.html#utool.util_list.flat_unique">[docs]</a><span class="k">def</span> <span class="nf">flat_unique</span><span class="p">(</span><span class="o">*</span><span class="n">lists_</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; returns items unique across all lists &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">unique</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">lists_</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="setdiff"><a class="viewcode-back" href="../../utool.html#utool.util_list.setdiff">[docs]</a><span class="k">def</span> <span class="nf">setdiff</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns list1 elements that are not in list2. preserves order of list1</span>

<span class="sd">    Args:</span>
<span class="sd">        list1 (list):</span>
<span class="sd">        list2 (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: new_list</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; list1 = [&#39;featweight_rowid&#39;, &#39;feature_rowid&#39;, &#39;config_rowid&#39;, &#39;featweight_forground_weight&#39;]</span>
<span class="sd">        &gt;&gt;&gt; list2 = [u&#39;featweight_rowid&#39;]</span>
<span class="sd">        &gt;&gt;&gt; new_list = setdiff_ordered(list1, list2)</span>
<span class="sd">        &gt;&gt;&gt; result = ut.list_str(new_list, nl=False)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [&#39;feature_rowid&#39;, &#39;config_rowid&#39;, &#39;featweight_forground_weight&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">set2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list1</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">set2</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="setdiff_flags"><a class="viewcode-back" href="../../utool.html#utool.util_list.setdiff_flags">[docs]</a><span class="k">def</span> <span class="nf">setdiff_flags</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">isetdiff_flags</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="isetdiff_flags"><a class="viewcode-back" href="../../utool.html#utool.util_list.isetdiff_flags">[docs]</a><span class="k">def</span> <span class="nf">isetdiff_flags</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    move to util_iter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">set2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">set2</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list1</span><span class="p">)</span>

</div>
<span class="n">setdiff_ordered</span> <span class="o">=</span> <span class="n">setdiff</span>


<div class="viewcode-block" id="setintersect_ordered"><a class="viewcode-back" href="../../utool.html#utool.util_list.setintersect_ordered">[docs]</a><span class="k">def</span> <span class="nf">setintersect_ordered</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns list1 elements that are in list2. preserves order of list1</span>

<span class="sd">    setintersect_ordered</span>

<span class="sd">    Args:</span>
<span class="sd">        list1 (list):</span>
<span class="sd">        list2 (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: new_list</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list1 = [1, 2, 3, 5, 8, 13, 21]</span>
<span class="sd">        &gt;&gt;&gt; list2 = [6, 4, 2, 21, 8]</span>
<span class="sd">        &gt;&gt;&gt; new_list = setintersect_ordered(list1, list2)</span>
<span class="sd">        &gt;&gt;&gt; result = new_list</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [2, 8, 21]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list1</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">)]</span>

</div>
<span class="n">setintersect</span> <span class="o">=</span> <span class="n">setintersect_ordered</span>


<div class="viewcode-block" id="sortedby"><a class="viewcode-back" href="../../utool.html#utool.util_list.sortedby">[docs]</a><span class="k">def</span> <span class="nf">sortedby</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">key_list</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; sorts ``item_list`` using key_list</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list): list to sort</span>
<span class="sd">        key_list (list): list to sort by</span>
<span class="sd">        reverse (bool): sort order is descending (largest first)</span>
<span class="sd">                        if reverse is True else acscending (smallest first)</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : ``list_`` sorted by the values of another ``list``. defaults to</span>
<span class="sd">        ascending order</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        sortedby2</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import utool</span>
<span class="sd">        &gt;&gt;&gt; list_    = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; key_list = [2, 5, 3, 1, 5]</span>
<span class="sd">        &gt;&gt;&gt; result = utool.sortedby(list_, key_list, reverse=True)</span>
<span class="sd">        [5, 2, 3, 1, 4]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">item_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_list</span><span class="p">),</span> <span class="p">(</span>
        <span class="s">&#39;Expected same len. Got: </span><span class="si">%r</span><span class="s"> != </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_list</span><span class="p">)))</span>
    <span class="n">sorted_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="ow">in</span>
                   <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">key_list</span><span class="p">,</span> <span class="n">item_list</span><span class="p">)),</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">sorted_list</span>

</div>
<div class="viewcode-block" id="sortedby2"><a class="viewcode-back" href="../../utool.html#utool.util_list.sortedby2">[docs]</a><span class="k">def</span> <span class="nf">sortedby2</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; sorts ``item_list`` using key_list</span>

<span class="sd">    Args:</span>
<span class="sd">        item_list (list): list to sort</span>

<span class="sd">    Varargs:</span>
<span class="sd">        *args (list): multiple lists to sort by</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        reverse (bool): sort order is descending if True else acscending</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : ``list_`` sorted by the values of another ``list``. defaults to</span>
<span class="sd">        ascending order</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-sortedby2 --show</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; item_list = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; key_list1 = [1, 1, 2, 3, 4]</span>
<span class="sd">        &gt;&gt;&gt; key_list2 = [2, 1, 4, 1, 1]</span>
<span class="sd">        &gt;&gt;&gt; args = (key_list1, key_list2)</span>
<span class="sd">        &gt;&gt;&gt; kwargs = dict(reverse=False)</span>
<span class="sd">        &gt;&gt;&gt; result = ut.sortedby2(item_list, *args, **kwargs)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [2, 1, 3, 4, 5]</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; # Python 3 Compatibility Test</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; item_list = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; key_list1 = [&#39;a&#39;, &#39;a&#39;, 2, 3, 4]</span>
<span class="sd">        &gt;&gt;&gt; key_list2 = [&#39;b&#39;, &#39;a&#39;, 4, 1, 1]</span>
<span class="sd">        &gt;&gt;&gt; args = (key_list1, key_list2)</span>
<span class="sd">        &gt;&gt;&gt; kwargs = dict(reverse=False)</span>
<span class="sd">        &gt;&gt;&gt; result = ut.sortedby2(item_list, *args, **kwargs)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [3, 4, 5, 2, 1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">operator</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">item_list</span><span class="p">)</span> <span class="o">==</span> <span class="n">len_</span> <span class="k">for</span> <span class="n">len_</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">args</span><span class="p">)])</span>
    <span class="n">reverse</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;reverse&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">tup_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span>
    <span class="c">#print(tup_list)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">sorted_tups</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tup_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c"># Python 3 does not allow sorting mixed types</span>
        <span class="k">def</span> <span class="nf">keyfunc</span><span class="p">(</span><span class="n">tup</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">sorted_tups</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tup_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">keyfunc</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
    <span class="n">sorted_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">sorted_tups</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">sorted_list</span>

</div>
<div class="viewcode-block" id="list_unflat_take"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_unflat_take">[docs]</a><span class="k">def</span> <span class="nf">list_unflat_take</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">unflat_index_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        items_list (list):</span>
<span class="sd">        unflat_index_list (list):</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-list_unflat_take</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; items_list = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; unflat_index_list = [[0, 1], [2, 3], [0, 4]]</span>
<span class="sd">        &gt;&gt;&gt; result = list_unflat_take(items_list, unflat_index_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[1, 2], [3, 4], [1, 5]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">list_unflat_take</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span>
            <span class="n">take</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">xs</span> <span class="ow">in</span> <span class="n">unflat_index_list</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="argsort"><a class="viewcode-back" href="../../utool.html#utool.util_list.argsort">[docs]</a><span class="k">def</span> <span class="nf">argsort</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; like np.argsort but for lists</span>

<span class="sd">    Varargs:</span>
<span class="sd">        *args (list): multiple lists to sort by</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        reverse (bool): sort order is descending if True else acscending</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">sortedby2</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="index_complement"><a class="viewcode-back" href="../../utool.html#utool.util_list.index_complement">[docs]</a><span class="k">def</span> <span class="nf">index_complement</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">len_</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the other indicies in a list of length ``len_``</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mask1</span> <span class="o">=</span> <span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">len_</span><span class="p">)</span>
    <span class="n">mask2</span> <span class="o">=</span> <span class="n">not_list</span><span class="p">(</span><span class="n">mask1</span><span class="p">)</span>
    <span class="n">index_list_bar</span> <span class="o">=</span> <span class="n">list_where</span><span class="p">(</span><span class="n">mask2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">index_list_bar</span>

</div>
<div class="viewcode-block" id="take_complement"><a class="viewcode-back" href="../../utool.html#utool.util_list.take_complement">[docs]</a><span class="k">def</span> <span class="nf">take_complement</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">index_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Returns items in ``list_`` not indexed by index_list &quot;&quot;&quot;</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">not_list</span><span class="p">(</span><span class="n">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">compress</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="take"><a class="viewcode-back" href="../../utool.html#utool.util_list.take">[docs]</a><span class="k">def</span> <span class="nf">take</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">index_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; like np.take but for lists</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list): some indexable object</span>
<span class="sd">        index_list (list, slice, int): some indexing object</span>

<span class="sd">    Returns:</span>
<span class="sd">        list or scalar: subset of the list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-take</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [0, 1, 2, 3]</span>
<span class="sd">        &gt;&gt;&gt; index_list = [2, 0]</span>
<span class="sd">        &gt;&gt;&gt; result = take(list_, index_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [2, 0]</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [0, 1, 2, 3]</span>
<span class="sd">        &gt;&gt;&gt; index = 2</span>
<span class="sd">        &gt;&gt;&gt; result = take(list_, index)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        2</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [0, 1, 2, 3]</span>
<span class="sd">        &gt;&gt;&gt; index = slice(1, None, 2)</span>
<span class="sd">        &gt;&gt;&gt; result = take(list_, index)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [1, 3]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">list_</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">list_</span><span class="p">[</span><span class="n">index_list</span><span class="p">]</span>
    <span class="c">#if util_iter.isiterable(index_list):</span>
    <span class="c">#else:</span>

<span class="c"># def take</span>

<span class="c"># def take2(item_list, indicies, axis):</span>
<span class="c">#     def _get_axes(list_, axis);</span>
<span class="c">#     pass</span>

</div>
<div class="viewcode-block" id="take_percentile"><a class="viewcode-back" href="../../utool.html#utool.util_list.take_percentile">[docs]</a><span class="k">def</span> <span class="nf">take_percentile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">percent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; take the top `percent` items in a list rounding up &quot;&quot;&quot;</span>
    <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="n">percent</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="list_inverse_take"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_inverse_take">[docs]</a><span class="k">def</span> <span class="nf">list_inverse_take</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">index_list</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list): list in sorted domain</span>
<span class="sd">        index_list (list): index list of the unsorted domain</span>

<span class="sd">    Note:</span>
<span class="sd">        Seems to be logically equivalent to</span>
<span class="sd">        ut.take(list_, ut.argsort(index_list)), but faster</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: output_list_ - the input list in the unsorted domain</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-list_inverse_take</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; rank_list = [3, 2, 4, 1, 9, 2]</span>
<span class="sd">        &gt;&gt;&gt; prop_list = [0, 1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; index_list = ut.argsort(rank_list)</span>
<span class="sd">        &gt;&gt;&gt; sorted_prop_list = ut.take(prop_list, index_list)</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; list_ = sorted_prop_list</span>
<span class="sd">        &gt;&gt;&gt; output_list_  = list_inverse_take(list_, index_list)</span>
<span class="sd">        &gt;&gt;&gt; output_list2_ = ut.take(list_, ut.argsort(index_list))</span>
<span class="sd">        &gt;&gt;&gt; assert output_list_ == prop_list</span>
<span class="sd">        &gt;&gt;&gt; assert output_list2_ == prop_list</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = str(output_list_)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>

<span class="sd">    Timeit::</span>
<span class="sd">        %timeit list_inverse_take(list_, index_list)</span>
<span class="sd">        %timeit ut.take(list_, ut.argsort(index_list))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output_list_</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">index_list</span><span class="p">):</span>
        <span class="n">output_list_</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
    <span class="k">return</span> <span class="n">output_list_</span>

</div>
<div class="viewcode-block" id="where"><a class="viewcode-back" href="../../utool.html#utool.util_list.where">[docs]</a><span class="k">def</span> <span class="nf">where</span><span class="p">(</span><span class="n">flag_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; takes flags returns indexes of True values &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">flag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flag_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">flag</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="where_not_None"><a class="viewcode-back" href="../../utool.html#utool.util_list.where_not_None">[docs]</a><span class="k">def</span> <span class="nf">where_not_None</span><span class="p">(</span><span class="n">item_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; returns list of indexes of non None values</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        flag_None_items</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">item_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="flag_None_items"><a class="viewcode-back" href="../../utool.html#utool.util_list.flag_None_items">[docs]</a><span class="k">def</span> <span class="nf">flag_None_items</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="flag_not_None_items"><a class="viewcode-back" href="../../utool.html#utool.util_list.flag_not_None_items">[docs]</a><span class="k">def</span> <span class="nf">flag_not_None_items</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="scalar_input_map"><a class="viewcode-back" href="../../utool.html#utool.util_list.scalar_input_map">[docs]</a><span class="k">def</span> <span class="nf">scalar_input_map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">input_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Map like function</span>

<span class="sd">    Args:</span>
<span class="sd">        func: function to apply</span>
<span class="sd">        input_ : either an iterable or scalar value</span>

<span class="sd">    Returns:</span>
<span class="sd">        If ``input_`` is iterable this function behaves like map</span>
<span class="sd">        otherwise applies func to ``input_``</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">util_iter</span><span class="o">.</span><span class="n">isiterable</span><span class="p">(</span><span class="n">input_</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">input_</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">input_</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="partial_imap_1to1"><a class="viewcode-back" href="../../utool.html#utool.util_list.partial_imap_1to1">[docs]</a><span class="k">def</span> <span class="nf">partial_imap_1to1</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">si_func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; a bit messy &quot;&quot;&quot;</span>
    <span class="nd">@functools.wraps</span><span class="p">(</span><span class="n">si_func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">input_</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">util_iter</span><span class="o">.</span><span class="n">isiterable</span><span class="p">(</span><span class="n">input_</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">si_func</span><span class="p">(</span><span class="n">input_</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">si_func</span><span class="p">(</span><span class="n">input_</span><span class="p">)))</span>
    <span class="n">set_funcname</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="n">util_str</span><span class="o">.</span><span class="n">get_callable_name</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;_mapper_&#39;</span> <span class="o">+</span> <span class="n">get_funcname</span><span class="p">(</span><span class="n">si_func</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">wrapper</span>

</div>
<div class="viewcode-block" id="sample_zip"><a class="viewcode-back" href="../../utool.html#utool.util_list.sample_zip">[docs]</a><span class="k">def</span> <span class="nf">sample_zip</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">,</span> <span class="n">allow_overflow</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">per_bin</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Helper for sampling</span>

<span class="sd">    Given a list of lists, samples one item for each list and bins them into</span>
<span class="sd">    num_samples bins. If all sublists are of equal size this is equivilent to a</span>
<span class="sd">    zip, but otherewise consecutive bins will have monotonically less</span>
<span class="sd">    elemements</span>

<span class="sd">    # Doctest doesn&#39;t work with assertionerror</span>
<span class="sd">    #util_list.sample_zip(items_list, 2)</span>
<span class="sd">    #...</span>
<span class="sd">    #AssertionError: Overflow occured</span>

<span class="sd">    Args:</span>
<span class="sd">        items_list (list):</span>
<span class="sd">        num_samples (?):</span>
<span class="sd">        allow_overflow (bool):</span>
<span class="sd">        per_bin (int):</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple : (samples_list, overflow_samples)</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from utool import util_list</span>
<span class="sd">        &gt;&gt;&gt; items_list = [[1, 2, 3, 4, 0], [5, 6, 7], [], [8, 9], [10]]</span>
<span class="sd">        &gt;&gt;&gt; util_list.sample_zip(items_list, 5)</span>
<span class="sd">        ...</span>
<span class="sd">        [[1, 5, 8, 10], [2, 6, 9], [3, 7], [4], [0]]</span>
<span class="sd">        &gt;&gt;&gt; util_list.sample_zip(items_list, 2, allow_overflow=True)</span>
<span class="sd">        ...</span>
<span class="sd">        ([[1, 5, 8, 10], [2, 6, 9]], [3, 7, 4])</span>
<span class="sd">        &gt;&gt;&gt; util_list.sample_zip(items_list, 4, allow_overflow=True, per_bin=2)</span>
<span class="sd">        ...</span>
<span class="sd">        ([[1, 5, 8, 10, 2, 6, 9], [3, 7, 4], [], []], [0])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Prealloc a list of lists</span>
    <span class="n">samples_list</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)]</span>
    <span class="c"># Sample the ix-th value from every list</span>
    <span class="n">samples_iter</span> <span class="o">=</span> <span class="n">zip_longest</span><span class="p">(</span><span class="o">*</span><span class="n">items_list</span><span class="p">)</span>
    <span class="n">sx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">samples_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">),</span> <span class="n">samples_iter</span><span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">filter_Nones</span><span class="p">(</span><span class="n">samples_</span><span class="p">)</span>
        <span class="n">samples_list</span><span class="p">[</span><span class="n">sx</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
        <span class="c"># Put per_bin from each sublist into a sample</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ix</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">per_bin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sx</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c"># Check for overflow</span>
    <span class="k">if</span> <span class="n">allow_overflow</span><span class="p">:</span>
        <span class="n">overflow_samples</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">([</span><span class="n">filter_Nones</span><span class="p">(</span><span class="n">samples_</span><span class="p">)</span> <span class="k">for</span> <span class="n">samples_</span> <span class="ow">in</span> <span class="n">samples_iter</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">samples_list</span><span class="p">,</span> <span class="n">overflow_samples</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">samples_iter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&#39;Overflow occured&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">samples_list</span>

</div>
<div class="viewcode-block" id="sample_lists"><a class="viewcode-back" href="../../utool.html#utool.util_list.sample_lists">[docs]</a><span class="k">def</span> <span class="nf">sample_lists</span><span class="p">(</span><span class="n">items_list</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        items_list (list):</span>
<span class="sd">        num (int): (default = 1)</span>
<span class="sd">        seed (None): (default = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: samples_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-sample_lists</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; items_list = [[], [1, 2, 3], [4], [5, 6], [7, 8, 9, 10]]</span>
<span class="sd">        &gt;&gt;&gt; num = 2</span>
<span class="sd">        &gt;&gt;&gt; seed = 0</span>
<span class="sd">        &gt;&gt;&gt; samples_list = sample_lists(items_list, num, seed)</span>
<span class="sd">        &gt;&gt;&gt; result = (&#39;samples_list = %s&#39; % (str(samples_list),))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        samples_list = [[], [3, 2], [4], [5, 6], [10, 9]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span>
    <span class="k">def</span> <span class="nf">random_choice</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">num</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">samples_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">random_choice</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">items_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">samples_list</span>

</div>
<div class="viewcode-block" id="strided_sample"><a class="viewcode-back" href="../../utool.html#utool.util_list.strided_sample">[docs]</a><span class="k">def</span> <span class="nf">strided_sample</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; items = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; num = 3</span>
<span class="sd">        &gt;&gt;&gt; offset = 0</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; sample_items = strided_sample(items, num, offset)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = str(sample_items)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">math</span>
    <span class="n">stride</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">/</span> <span class="n">num</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sample_items</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="n">offset</span><span class="p">::</span><span class="n">stride</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">sample_items</span>

</div>
<div class="viewcode-block" id="issorted"><a class="viewcode-back" href="../../utool.html#utool.util_list.issorted">[docs]</a><span class="k">def</span> <span class="nf">issorted</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">le</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        op (builtin_function_or_method):</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool : True if the list is sorted</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">list_</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">list_</span><span class="p">[</span><span class="n">ix</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="find_nonconsec_indices"><a class="viewcode-back" href="../../utool.html#utool.util_list.find_nonconsec_indices">[docs]</a><span class="k">def</span> <span class="nf">find_nonconsec_indices</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">,</span> <span class="n">consec_vals</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    # TODO: rectify with above function</span>

<span class="sd">    Args:</span>
<span class="sd">        unique_vals (list):</span>
<span class="sd">        consec_vals (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        missing_ixs</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; unique_vals = np.array([-2, -1,  1,  2, 10])</span>
<span class="sd">        &gt;&gt;&gt; max_ = unique_vals.max()</span>
<span class="sd">        &gt;&gt;&gt; min_ = unique_vals.min()</span>
<span class="sd">        &gt;&gt;&gt; range_ = max_ - min_</span>
<span class="sd">        &gt;&gt;&gt; consec_vals = np.linspace(min_, max_ + 1, range_ + 2)</span>
<span class="sd">        &gt;&gt;&gt; missing_ixs = find_nonconsec_indices(unique_vals, consec_vals)</span>
<span class="sd">        &gt;&gt;&gt; result = (consec_vals[missing_ixs])</span>
<span class="sd">        [ 0.  3.  4.  5.  6.  7.  8.  9.]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">missing_ixs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">valx</span>   <span class="o">=</span> <span class="mi">0</span>
    <span class="n">consecx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">valx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">)</span> <span class="ow">and</span> <span class="n">consecx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">consec_vals</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">unique_vals</span><span class="p">[</span><span class="n">valx</span><span class="p">]</span> <span class="o">!=</span> <span class="n">consec_vals</span><span class="p">[</span><span class="n">consecx</span><span class="p">]:</span>
            <span class="n">missing_ixs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">consecx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">valx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">consecx</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">missing_ixs</span>

</div>
<div class="viewcode-block" id="group_consecutives"><a class="viewcode-back" href="../../utool.html#utool.util_list.group_consecutives">[docs]</a><span class="k">def</span> <span class="nf">group_consecutives</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return list of consecutive lists of numbers from data (number list).</span>

<span class="sd">    References:</span>
<span class="sd">        http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">run</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">run</span><span class="p">]</span>
    <span class="n">expect</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="o">==</span> <span class="n">expect</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">expect</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">run</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">item</span> <span class="o">+</span> <span class="n">stepsize</span>
    <span class="k">return</span> <span class="n">result</span>

</div>
<div class="viewcode-block" id="group_consecutives_numpy"><a class="viewcode-back" href="../../utool.html#utool.util_list.group_consecutives_numpy">[docs]</a><span class="k">def</span> <span class="nf">group_consecutives_numpy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        data (?):</span>
<span class="sd">        stepsize (int):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: list of ndarrays</span>

<span class="sd">    References:</span>
<span class="sd">        http://stackoverflow.com/questions/7352684/how-to-find-the-groups-of-consecutive-elements-from-an-array-in-numpy</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-group_consecutives</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; data = np.array([  0,   1,   2,   3,   4, 320, 636, 637, 638, 639])</span>
<span class="sd">        &gt;&gt;&gt; stepsize = 1</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; result = group_consecutives(data, stepsize)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [array([0, 1, 2, 3, 4]), array([320]), array([636, 637, 638, 639])]</span>

<span class="sd">    Timeit::</span>
<span class="sd">        %timeit group_consecutives_numpy(data, stepsize) #  14.8 µs per loop</span>
<span class="sd">        %timeit group_consecutives(data, stepsize) # 4.47 µs per loop</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="n">stepsize</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="debug_consec_list"><a class="viewcode-back" href="../../utool.html#utool.util_list.debug_consec_list">[docs]</a><span class="k">def</span> <span class="nf">debug_consec_list</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple of (missing_items, missing_indices, duplicate_items)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">issorted</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;warning list is not sorted. indices will not match&#39;</span><span class="p">)</span>
    <span class="n">sortedlist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">sortedlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">last</span> <span class="o">=</span> <span class="n">start</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">missing_vals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">missing_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">duplicate_items</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sortedlist</span><span class="p">):</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">item</span> <span class="o">-</span> <span class="n">last</span>
        <span class="k">if</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">missing_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">miss</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">last</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">last</span> <span class="o">+</span> <span class="n">diff</span><span class="p">):</span>
                <span class="n">missing_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">miss</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">diff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">duplicate_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">diff</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c"># Expected case</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&#39;We sorted the list. diff can not be negative&#39;</span><span class="p">)</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">item</span>
    <span class="k">return</span> <span class="n">missing_vals</span><span class="p">,</span> <span class="n">missing_indices</span><span class="p">,</span> <span class="n">duplicate_items</span>

</div>
<div class="viewcode-block" id="find_duplicate_items"><a class="viewcode-back" href="../../utool.html#utool.util_list.find_duplicate_items">[docs]</a><span class="k">def</span> <span class="nf">find_duplicate_items</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        items (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: duplicate_map of indexes</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-find_duplicate_items</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; items = [0, 1, 2, 3, 3, 0, 12, 2, 9]</span>
<span class="sd">        &gt;&gt;&gt; duplicate_map = find_duplicate_items(items)</span>
<span class="sd">        &gt;&gt;&gt; result = str(duplicate_map)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
    <span class="c"># Build item histogram</span>
    <span class="n">duplicate_map</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ddict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
        <span class="n">duplicate_map</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
    <span class="c"># remove singleton items</span>
    <span class="n">singleton_keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">duplicate_map</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">duplicate_map</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">singleton_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">singleton_keys</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">duplicate_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">duplicate_map</span>


<span class="c">#get_non_consecutive_positions = debug_consec_list</span>

</div>
<div class="viewcode-block" id="duplicates_exist"><a class="viewcode-back" href="../../utool.html#utool.util_list.duplicates_exist">[docs]</a><span class="k">def</span> <span class="nf">duplicates_exist</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; returns if list has duplicates &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">items</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span>

</div>
<div class="viewcode-block" id="isunique"><a class="viewcode-back" href="../../utool.html#utool.util_list.isunique">[docs]</a><span class="k">def</span> <span class="nf">isunique</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="n">duplicates_exist</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="print_duplicate_map"><a class="viewcode-back" href="../../utool.html#utool.util_list.print_duplicate_map">[docs]</a><span class="k">def</span> <span class="nf">print_duplicate_map</span><span class="p">(</span><span class="n">duplicate_map</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c"># args are corresponding lists</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
    <span class="n">printfn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;printfn&#39;</span><span class="p">,</span> <span class="k">print</span><span class="p">)</span>
    <span class="n">printfn</span><span class="p">(</span><span class="s">&#39;There are </span><span class="si">%d</span><span class="s"> duplicates&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">duplicate_map</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">index_list</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">duplicate_map</span><span class="p">):</span>
        <span class="n">printfn</span><span class="p">(</span><span class="s">&#39;item=</span><span class="si">%s</span><span class="s"> appears </span><span class="si">%d</span><span class="s"> times at indices: </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_list</span><span class="p">),</span> <span class="n">index_list</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">argx</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="c">#argname = &#39;arg%d&#39; % (argx)</span>
            <span class="n">argname</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_varname_from_stack</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">:</span>
                <span class="n">printfn</span><span class="p">(</span><span class="s">&#39; * </span><span class="si">%s</span><span class="s">[</span><span class="si">%d</span><span class="s">] = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">argname</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">arg</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">duplicate_map</span>

</div>
<div class="viewcode-block" id="debug_duplicate_items"><a class="viewcode-back" href="../../utool.html#utool.util_list.debug_duplicate_items">[docs]</a><span class="k">def</span> <span class="nf">debug_duplicate_items</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
    <span class="n">pad_stdout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;pad_stdout&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pad_stdout</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">&#39;[util_list] +--- DEBUG DUPLICATE ITEMS  </span><span class="si">%r</span><span class="s"> ---&#39;</span> <span class="o">%</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_varname_from_locals</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_caller_locals</span><span class="p">()))</span>
    <span class="k">def</span> <span class="nf">printfn</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[util_list] |&#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">)</span>
    <span class="c">#with ut.Indenter(&#39;[util_list] | &#39;):</span>
    <span class="n">duplicate_map</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">find_duplicate_items</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    <span class="n">printkw</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;printfn&#39;</span><span class="p">:</span> <span class="n">printfn</span><span class="p">}</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">print_duplicate_map</span><span class="p">(</span><span class="n">duplicate_map</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">printkw</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;[util_list] L--- FINISH DEBUG DUPLICATE ITEMS ---&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pad_stdout</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">duplicate_map</span>

</div>
<div class="viewcode-block" id="list_depth"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_depth">[docs]</a><span class="k">def</span> <span class="nf">list_depth</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="nb">max</span><span class="p">,</span> <span class="n">_depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the deepest level of nesting within a list of lists</span>

<span class="sd">    Args:</span>
<span class="sd">       list_  : a nested listlike object</span>
<span class="sd">       func   : depth aggregation strategy (defaults to max)</span>
<span class="sd">       _depth : internal var</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[[[[1]]], [3]], [[1], [3]], [[1], [3]]]</span>
<span class="sd">        &gt;&gt;&gt; result = (list_depth(list_, _depth=0))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">depth_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">list_depth</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">_depth</span><span class="o">=</span><span class="n">_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span>  <span class="n">list_</span> <span class="k">if</span> <span class="n">util_type</span><span class="o">.</span><span class="n">is_listlike</span><span class="p">(</span><span class="n">item</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">depth_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">depth_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_depth</span>

</div>
<div class="viewcode-block" id="list_deep_types"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_deep_types">[docs]</a><span class="k">def</span> <span class="nf">list_deep_types</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns all types in a deep list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">type_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">util_type</span><span class="o">.</span><span class="n">is_listlike</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="n">type_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_deep_types</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">type_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">type_list</span>

</div>
<div class="viewcode-block" id="depth_profile"><a class="viewcode-back" href="../../utool.html#utool.util_list.depth_profile">[docs]</a><span class="k">def</span> <span class="nf">depth_profile</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">compress_homogenous</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">compress_consecutive</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">new_depth</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns a nested list corresponding the shape of the nested structures</span>
<span class="sd">    lists represent depth, tuples represent shape. The values of the items do</span>
<span class="sd">    not matter. only the lengths.</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        max_depth (None):</span>
<span class="sd">        compress_homogenous (bool):</span>
<span class="sd">        compress_consecutive (bool):  experimental</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-depth_profile</span>

<span class="sd">    Setup:</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>

<span class="sd">    Example0:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]], [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]]]</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        (2, 3, 4)</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[[[[1]]], [3, 4, 33]], [[1], [2, 3], [4, [5, 5]]], [1, 3]]</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[(1, 1, 1), 3], [1, 2, [1, 2]], 2]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[[[[1]]], [3, 4, 33]], [[1], [2, 3], [4, [5, 5]]], [1, 3]]</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_, max_depth=1)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[(1, &#39;1&#39;), 3], [1, 2, [1, &#39;2&#39;]], 2]</span>

<span class="sd">    Example3:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[[1, 2], [1, 2, 3]], None]</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_, compress_homogenous=True)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[2, 3], 1]</span>

<span class="sd">    Example4:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[3, 2], [3, 2], [3, 2], [3, 2], [3, 2], [3, 2], [9, 5, 3], [2, 2]]</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_, compress_homogenous=True, compress_consecutive=True)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [2] * 6 + [3, 2]</span>

<span class="sd">    Example5:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[[3, 9], 2], [[3, 9], 2], [[3, 9], 2], [[3, 9], 2]]  #, [3, 2], [3, 2]]</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_, compress_homogenous=True, compress_consecutive=True)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        (4, [2, 1])</span>

<span class="sd">    Example6:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[[[1, 2]], [1, 2]], [[[1, 2]], [1, 2]], [[[0, 2]], [1]]]</span>
<span class="sd">        &gt;&gt;&gt; result1 = depth_profile(list_, compress_homogenous=True, compress_consecutive=False)</span>
<span class="sd">        &gt;&gt;&gt; result2 = depth_profile(list_, compress_homogenous=True, compress_consecutive=True)</span>
<span class="sd">        &gt;&gt;&gt; result = str(result1) + &#39;\n&#39; + str(result2)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[(1, 2), 2], [(1, 2), 2], [(1, 2), 1]]</span>
<span class="sd">        [[(1, 2), 2]] * 2 + [[(1, 2), 1]]</span>

<span class="sd">    Example7:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[{&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4, 5]}, [1, 2, 3]], None]</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_, compress_homogenous=True)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>

<span class="sd">    Example8:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[[1]], [[[1, 1], [1, 1]]], [[[[1, 3], 1], [[1, 3, 3], 1, 1]]]]</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_, compress_homogenous=True)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>

<span class="sd">    Example9:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; list_ = []</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>

<span class="sd">        # THIS IS AN ERROR???</span>
<span class="sd">        SHOULD BE</span>
<span class="sd">        #[1, 1], [1, 2, 2], (1, ([1, 2]), (</span>

<span class="sd">    Example10:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; fm1 = [[0, 0], [0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; fm2 = [[0, 0], [0, 0], [0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; fm3 = [[0, 0], [0, 0], [0, 0], [0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; list_ = [0, 0, 0]</span>
<span class="sd">        &gt;&gt;&gt; list_ = [fm1, fm2, fm3]</span>
<span class="sd">        &gt;&gt;&gt; max_depth = 0</span>
<span class="sd">        &gt;&gt;&gt; new_depth = True</span>
<span class="sd">        &gt;&gt;&gt; result = depth_profile(list_, max_depth=max_depth, new_depth=new_depth)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">list_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">list_</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>   <span class="c"># handle dict</span>
    <span class="n">level_shape_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c"># For a pure bottom level list return the length</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">util_type</span><span class="o">.</span><span class="n">is_listlike</span><span class="p">,</span> <span class="n">list_</span><span class="p">)):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">False</span> <span class="ow">and</span> <span class="n">new_depth</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c"># max_depth_ = None if max_depth is None else max_depth - 1</span>
        <span class="c"># if max_depth_ is None or max_depth_ &gt; 0:</span>
        <span class="c">#     pass</span>
        <span class="c"># else:</span>
        <span class="c">#     for item in list_:</span>
        <span class="c">#         if isinstance(item, dict):</span>
        <span class="c">#             item = list(item.values())  # handle dict</span>
        <span class="c">#         if util_type.is_listlike(item):</span>
        <span class="c">#             if max_depth is None:</span>
        <span class="c">#                 level_shape_list.append(depth_profile(item, None))</span>
        <span class="c">#             else:</span>
        <span class="c">#                 if max_depth &gt;= 0:</span>
        <span class="c">#                     level_shape_list.append(depth_profile(item, max_depth - 1))</span>
        <span class="c">#                 else:</span>
        <span class="c">#                     level_shape_list.append(str(len(item)))</span>
        <span class="c">#         else:</span>
        <span class="c">#             level_shape_list.append(1)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">item</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>  <span class="c"># handle dict</span>
            <span class="k">if</span> <span class="n">util_type</span><span class="o">.</span><span class="n">is_listlike</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">level_shape_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">None</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">max_depth</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">level_shape_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth_profile</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">level_shape_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">level_shape_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">compress_homogenous</span><span class="p">:</span>
        <span class="c"># removes redudant information by returning a shape duple</span>
        <span class="k">if</span> <span class="n">allsame</span><span class="p">(</span><span class="n">level_shape_list</span><span class="p">):</span>
            <span class="n">dim_</span> <span class="o">=</span> <span class="n">level_shape_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">len_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">level_shape_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dim_</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">level_shape_list</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">len_</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">dim_</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">level_shape_list</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">len_</span><span class="p">,</span> <span class="n">dim_</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">compress_consecutive</span><span class="p">:</span>
        <span class="n">hash_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">level_shape_list</span><span class="p">)))</span>
        <span class="n">consec_list</span> <span class="o">=</span> <span class="n">group_consecutives</span><span class="p">(</span><span class="n">hash_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">consec_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">level_shape_list</span><span class="p">):</span>
            <span class="n">len_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">consec_list</span><span class="p">))</span>
            <span class="n">cumsum_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">len_list</span><span class="p">)</span>
            <span class="n">consec_str</span> <span class="o">=</span> <span class="s">&#39;[&#39;</span>
            <span class="n">thresh</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">len_</span><span class="p">,</span> <span class="n">cumsum</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">len_list</span><span class="p">,</span> <span class="n">cumsum_list</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">level_shape_list</span><span class="p">[</span><span class="n">cumsum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">len_</span> <span class="o">&gt;</span> <span class="n">thresh</span><span class="p">:</span>
                    <span class="n">consec_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;] * &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">len_</span><span class="p">)</span>
                    <span class="n">consec_str</span> <span class="o">+=</span> <span class="s">&#39; + [&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">consec_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;, &#39;</span>
            <span class="k">if</span> <span class="n">consec_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;, &#39;</span><span class="p">):</span>
                <span class="n">consec_str</span> <span class="o">=</span> <span class="n">consec_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="c">#consec_str += &#39;]&#39;</span>
            <span class="c">#consec_str = consec_str.rstrip(&#39;, &#39;).rstrip(&#39;]&#39;)</span>
            <span class="c">#consec_str = consec_str.rstrip(&#39;, &#39;)</span>
            <span class="c">#if consec_str.endswith(&#39;]&#39;):</span>
            <span class="c">#    consec_str = consec_str[:-1]</span>
            <span class="n">consec_str</span> <span class="o">+=</span> <span class="s">&#39;]&#39;</span>
            <span class="n">level_shape_list</span> <span class="o">=</span> <span class="n">consec_str</span>
    <span class="k">return</span> <span class="n">level_shape_list</span>

</div>
<div class="viewcode-block" id="list_type"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_type">[docs]</a><span class="k">def</span> <span class="nf">list_type</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="n">types</span> <span class="o">=</span>  <span class="n">unique_ordered</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">list_</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">types</span>

</div>
<div class="viewcode-block" id="list_type_profile"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_type_profile">[docs]</a><span class="k">def</span> <span class="nf">list_type_profile</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">compress_homogenous</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    similar to depth_profile but reports types</span>

<span class="sd">    Args:</span>
<span class="sd">        sequence (?):</span>
<span class="sd">        compress_homogenous (bool): (default = True)</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        compress_homogenous</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: level_type_str</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-list_type_profile</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; sequence = []</span>
<span class="sd">        &gt;&gt;&gt; compress_homogenous = True</span>
<span class="sd">        &gt;&gt;&gt; level_type_str = list_type_profile(sequence, compress_homogenous)</span>
<span class="sd">        &gt;&gt;&gt; result = (&#39;level_type_str = %s&#39; % (str(level_type_str),))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># For a pure bottom level list return the length</span>
    <span class="c">#if not any(map(util_type.is_listlike, sequence)) or (isinstance(sequence, np.ndarray) and sequence.dtype != object):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">util_type</span><span class="o">.</span><span class="n">is_listlike</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sequence</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="nb">object</span><span class="p">):</span>
        <span class="n">typename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;&lt;type </span><span class="se">\&#39;</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&#39;</span><span class="s">&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">with_dtype</span> <span class="ow">and</span> <span class="n">typename</span> <span class="o">==</span> <span class="s">&#39;numpy.ndarray&#39;</span><span class="p">:</span>
            <span class="n">typename</span> <span class="o">=</span> <span class="n">typename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;numpy.&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="n">typename</span> <span class="o">+=</span> <span class="s">&#39;[</span><span class="si">%s</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sequence</span><span class="o">.</span><span class="n">dtype</span><span class="p">,)</span>

        <span class="n">level_type_str</span> <span class="o">=</span> <span class="n">typename</span>
        <span class="k">return</span> <span class="n">level_type_str</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;&#39;</span>

    <span class="n">level_type_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="c">#if util_type.is_listlike(item):</span>
        <span class="n">level_type_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_type_profile</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">with_dtype</span><span class="o">=</span><span class="n">with_dtype</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">compress_homogenous</span><span class="p">:</span>
        <span class="c"># removes redudant information by returning a type and number</span>
        <span class="k">if</span> <span class="n">allsame</span><span class="p">(</span><span class="n">level_type_list</span><span class="p">):</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="n">level_type_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">level_type_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;*&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">level_type_list</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">level_type_str</span> <span class="o">=</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">level_type_list</span><span class="p">)</span>
    <span class="n">typename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;&lt;type </span><span class="se">\&#39;</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&#39;</span><span class="s">&gt;&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="n">level_type_str</span> <span class="o">=</span> <span class="n">typename</span> <span class="o">+</span> <span class="s">&#39;(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">level_type_str</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;)&#39;</span>
    <span class="k">return</span> <span class="n">level_type_str</span>

</div>
<span class="n">type_profile</span> <span class="o">=</span> <span class="n">list_type_profile</span>


<div class="viewcode-block" id="list_cover"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_cover">[docs]</a><span class="k">def</span> <span class="nf">list_cover</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    returns boolean for each position in list1 if it is in list2</span>

<span class="sd">    Args:</span>
<span class="sd">        list1 (list):</span>
<span class="sd">        list2 (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: incover_list - true where list1 intersects list2</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-list_cover</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; list1 = [1, 2, 3, 4, 5, 6]</span>
<span class="sd">        &gt;&gt;&gt; list2 = [2, 3, 6]</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; incover_list = list_cover(list1, list2)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = str(incover_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [False, True, True, False, False, True]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">set2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">list2</span><span class="p">)</span>
    <span class="n">incover_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">item1</span> <span class="ow">in</span> <span class="n">set2</span> <span class="k">for</span> <span class="n">item1</span> <span class="ow">in</span> <span class="n">list1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">incover_list</span>

</div>
<div class="viewcode-block" id="and_lists"><a class="viewcode-back" href="../../utool.html#utool.util_list.and_lists">[docs]</a><span class="k">def</span> <span class="nf">and_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="c">#[all(tup) for tup in zip(*args)]</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">util_iter</span><span class="o">.</span><span class="n">and_iters</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="xor_lists"><a class="viewcode-back" href="../../utool.html#utool.util_list.xor_lists">[docs]</a><span class="k">def</span> <span class="nf">xor_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list:</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-xor_lists</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; args = ([True, False, False, True], [True, True, False, False])</span>
<span class="sd">        &gt;&gt;&gt; result = xor_lists(*args)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [False, True, False, True]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">xor</span><span class="p">,</span> <span class="n">tup</span><span class="p">)</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)]</span>

</div>
<div class="viewcode-block" id="not_list"><a class="viewcode-back" href="../../utool.html#utool.util_list.not_list">[docs]</a><span class="k">def</span> <span class="nf">not_list</span><span class="p">(</span><span class="n">flag_list</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="ow">not</span> <span class="n">flag</span> <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flag_list</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="or_lists"><a class="viewcode-back" href="../../utool.html#utool.util_list.or_lists">[docs]</a><span class="k">def</span> <span class="nf">or_lists</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">any</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)]</span>

</div>
<div class="viewcode-block" id="make_sortby_func"><a class="viewcode-back" href="../../utool.html#utool.util_list.make_sortby_func">[docs]</a><span class="k">def</span> <span class="nf">make_sortby_func</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">sortxs_</span> <span class="o">=</span> <span class="n">argsort</span><span class="p">(</span><span class="n">item_list</span><span class="p">)</span>
    <span class="n">sortxs</span> <span class="o">=</span> <span class="n">sortxs_</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">reverse</span> <span class="k">else</span> <span class="n">sortxs_</span>
    <span class="k">def</span> <span class="nf">sortby_func</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">take</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">sortxs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sortby_func</span>

</div>
<div class="viewcode-block" id="filter_startswith"><a class="viewcode-back" href="../../utool.html#utool.util_list.filter_startswith">[docs]</a><span class="k">def</span> <span class="nf">filter_startswith</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">str_</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">item_startswith</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">item_startswith</span><span class="p">,</span> <span class="n">list_</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="list_roll"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_roll">[docs]</a><span class="k">def</span> <span class="nf">list_roll</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Like numpy.roll for python lists</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        n (int):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list:</span>

<span class="sd">    References:</span>
<span class="sd">        http://stackoverflow.com/questions/9457832/python-list-rotation</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; n = 2</span>
<span class="sd">        &gt;&gt;&gt; result = list_roll(list_, n)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [4, 5, 1, 2, 3]</span>

<span class="sd">    Ignore:</span>
<span class="sd">        np.roll(list_, n)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">list_</span><span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">:]</span> <span class="o">+</span> <span class="n">list_</span><span class="p">[:</span><span class="o">-</span><span class="n">n</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="list_argmax"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_argmax">[docs]</a><span class="k">def</span> <span class="nf">list_argmax</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">list_</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="list_argmaxima"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_argmaxima">[docs]</a><span class="k">def</span> <span class="nf">list_argmaxima</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: argmaxima</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-list_argmaxima</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = np.array([1, 2, 3, 3, 3, 2, 1])</span>
<span class="sd">        &gt;&gt;&gt; argmaxima = list_argmaxima(list_)</span>
<span class="sd">        &gt;&gt;&gt; result = (&#39;argmaxima = %s&#39; % (str(argmaxima),))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        argmaxima = [2 3 4]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">argmax</span> <span class="o">=</span> <span class="n">list_argmax</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>
    <span class="n">maxval</span> <span class="o">=</span> <span class="n">list_</span><span class="p">[</span><span class="n">argmax</span><span class="p">]</span>
    <span class="n">argmaxima</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">maxval</span><span class="p">,</span> <span class="n">list_</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">argmaxima</span>

</div>
<div class="viewcode-block" id="make_index_lookup"><a class="viewcode-back" href="../../utool.html#utool.util_list.make_index_lookup">[docs]</a><span class="k">def</span> <span class="nf">make_index_lookup</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list): assumed to have unique items</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: mapping from item to index</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-make_index_lookup</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; list_ = [5, 3, 8, 2]</span>
<span class="sd">        &gt;&gt;&gt; idx2_item = ut.make_index_lookup(list_)</span>
<span class="sd">        &gt;&gt;&gt; result = ut.dict_str(idx2_item, nl=False)</span>
<span class="sd">        &gt;&gt;&gt; assert ut.dict_take(idx2_item, list_) == list(range(len(list_)))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        {2: 3, 3: 1, 5: 0, 8: 2}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">))))</span>

</div>
<div class="viewcode-block" id="list_transpose"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_transpose">[docs]</a><span class="k">def</span> <span class="nf">list_transpose</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list:</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-list_transpose</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[1, 2], [3, 4]]</span>
<span class="sd">        &gt;&gt;&gt; result = list_transpose(list_)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [(1, 3), (2, 4)]</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [[1, 2, 3], [3, 4]]</span>
<span class="sd">        &gt;&gt;&gt; try:</span>
<span class="sd">        &gt;&gt;&gt;     result = list_transpose(list_)</span>
<span class="sd">        &gt;&gt;&gt; except AssertionError:</span>
<span class="sd">        &gt;&gt;&gt;     pass</span>
<span class="sd">        &gt;&gt;&gt; else:</span>
<span class="sd">        &gt;&gt;&gt;     assert False, &#39;should error&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#import utool as ut</span>
    <span class="n">num_cols_set</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">list_</span><span class="p">))))</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">num_cols_set</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;inconsistent num_cols_set=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_cols_set</span><span class="p">,)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">list_</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="delete_items_by_index"><a class="viewcode-back" href="../../utool.html#utool.util_list.delete_items_by_index">[docs]</a><span class="k">def</span> <span class="nf">delete_items_by_index</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">index_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        index_list (list):</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-delete_items_by_index</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; list_ = [8, 1, 8, 1, 6, 6, 3, 4, 4, 5, 6]</span>
<span class="sd">        &gt;&gt;&gt; index_list = [2, -1]</span>
<span class="sd">        &gt;&gt;&gt; result = delete_items_by_index(list_, index_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [8, 1, 1, 6, 6, 3, 4, 4, 5]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Rectify negative indicies</span>
    <span class="n">index_list_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span> <span class="o">+</span> <span class="n">index</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">]</span>
    <span class="c"># Remove largest indicies first</span>
    <span class="n">index_list_</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">index_list_</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">index_list_</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">list_</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">list_</span>

</div>
<div class="viewcode-block" id="unflat_map"><a class="viewcode-back" href="../../utool.html#utool.util_list.unflat_map">[docs]</a><span class="k">def</span> <span class="nf">unflat_map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">unflat_items</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Uses an ibeis lookup function with a non-flat rowid list.</span>
<span class="sd">    In essence this is equivilent to [list(map(func, _items)) for _items in unflat_items].</span>
<span class="sd">    The utility of this function is that it only calls method once.</span>
<span class="sd">    This is more efficient for calls that can take a list of inputs</span>

<span class="sd">    Args:</span>
<span class="sd">        func (func): function</span>
<span class="sd">        unflat_items (list): list of rowid lists</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of values: unflat_vals</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --test-unflat_map</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; vectorized = False</span>
<span class="sd">        &gt;&gt;&gt; kwargs = {}</span>
<span class="sd">        &gt;&gt;&gt; func = lambda x: x + 1</span>
<span class="sd">        &gt;&gt;&gt; unflat_items = [[], [1, 2, 3], [4, 5], [6, 7, 8, 9], [], []]</span>
<span class="sd">        &gt;&gt;&gt; unflat_vals = unflat_map(func, unflat_items)</span>
<span class="sd">        &gt;&gt;&gt; result = str(unflat_vals)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[], [2, 3, 4], [5, 6], [7, 8, 9, 10], [], []]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
    <span class="c"># First flatten the list, and remember the original dimensions</span>
    <span class="n">flat_items</span><span class="p">,</span> <span class="n">reverse_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">invertible_flatten2</span><span class="p">(</span><span class="n">unflat_items</span><span class="p">)</span>
    <span class="c"># Then preform the lookup / implicit mapping</span>
    <span class="k">if</span> <span class="n">vectorized</span><span class="p">:</span>
        <span class="c"># func is vectorized</span>
        <span class="n">flat_vals</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">flat_items</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">flat_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">flat_items</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flat_vals</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">flat_items</span><span class="p">),</span> <span class="p">(</span>
            <span class="s">&#39;flat lens not the same, len(flat_vals)=</span><span class="si">%d</span><span class="s"> len(flat_items)=</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flat_vals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">flat_items</span><span class="p">),))</span>
    <span class="c"># Then ut.unflatten2 the results to the original input dimensions</span>
    <span class="n">unflat_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">unflatten2</span><span class="p">(</span><span class="n">flat_vals</span><span class="p">,</span> <span class="n">reverse_list</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">unflat_vals</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">unflat_items</span><span class="p">),</span> <span class="p">(</span>
            <span class="s">&#39;unflat lens not the same, len(unflat_vals)=</span><span class="si">%d</span><span class="s"> len(unflat_rowids)=</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unflat_vals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">unflat_items</span><span class="p">),))</span>
    <span class="k">return</span> <span class="n">unflat_vals</span>

</div>
<div class="viewcode-block" id="unflat_vecmap"><a class="viewcode-back" href="../../utool.html#utool.util_list.unflat_vecmap">[docs]</a><span class="k">def</span> <span class="nf">unflat_vecmap</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">unflat_items</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; unflat map for vectorized functions &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
    <span class="c"># First flatten the list, and remember the original dimensions</span>
    <span class="n">flat_items</span><span class="p">,</span> <span class="n">reverse_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">invertible_flatten2</span><span class="p">(</span><span class="n">unflat_items</span><span class="p">)</span>
    <span class="c"># Then preform the lookup / implicit mapping</span>
    <span class="n">flat_vals</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">flat_items</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flat_vals</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">flat_items</span><span class="p">),</span> <span class="p">(</span>
            <span class="s">&#39;flat lens not the same, len(flat_vals)=</span><span class="si">%d</span><span class="s"> len(flat_items)=</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flat_vals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">flat_items</span><span class="p">),))</span>
    <span class="c"># Then ut.unflatten2 the results to the original input dimensions</span>
    <span class="n">unflat_vals</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">unflatten2</span><span class="p">(</span><span class="n">flat_vals</span><span class="p">,</span> <span class="n">reverse_list</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">unflat_vals</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">unflat_items</span><span class="p">),</span> <span class="p">(</span>
            <span class="s">&#39;unflat lens not the same, len(unflat_vals)=</span><span class="si">%d</span><span class="s"> len(unflat_rowids)=</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unflat_vals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">unflat_items</span><span class="p">),))</span>
    <span class="k">return</span> <span class="n">unflat_vals</span>

</div>
<div class="viewcode-block" id="list_getattr"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_getattr">[docs]</a><span class="k">def</span> <span class="nf">list_getattr</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">attrname</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="n">attrname</span><span class="p">),</span> <span class="n">list_</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="list_reshape"><a class="viewcode-back" href="../../utool.html#utool.util_list.list_reshape">[docs]</a><span class="k">def</span> <span class="nf">list_reshape</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    reshapes leaving trailing dimnsions in front if prod(new_shape) != len(list_)</span>

<span class="sd">    Args:</span>
<span class="sd">        list_ (list):</span>
<span class="sd">        new_shape (tuple):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: list_</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m utool.util_list --exec-list_reshape --show</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; list_ = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]</span>
<span class="sd">        &gt;&gt;&gt; new_shape = (2, 2, 3)</span>
<span class="sd">        &gt;&gt;&gt; newlist = list_reshape(list_, new_shape)</span>
<span class="sd">        &gt;&gt;&gt; depth = ut.depth_profile(newlist)</span>
<span class="sd">        &gt;&gt;&gt; result = (&#39;list_ = %s&#39; % (ut.repr2(newlist, nl=1),))</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;depth = %r&#39; % (depth,))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        &gt;&gt;&gt; newlist2 = np.reshape(list_, depth).tolist()</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(newlist, newlist2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">trail</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">total</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>
    <span class="n">newlist</span> <span class="o">=</span> <span class="n">list_</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">new_shape</span><span class="p">):</span>
        <span class="n">slice_</span> <span class="o">=</span> <span class="p">(</span><span class="n">newlist</span><span class="p">[</span><span class="n">i</span><span class="p">::</span><span class="n">dim</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
        <span class="n">newlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">slice_</span><span class="p">)))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">trail</span><span class="p">:</span>
        <span class="n">newlist</span> <span class="o">=</span> <span class="n">newlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">newlist</span>

</div>
<div class="viewcode-block" id="index_to_boolmask"><a class="viewcode-back" href="../../utool.html#utool.util_list.index_to_boolmask">[docs]</a><span class="k">def</span> <span class="nf">index_to_boolmask</span><span class="p">(</span><span class="n">index_list</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        index_list (list):</span>
<span class="sd">        maxval (None): (default = None)</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        maxval</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: mask</span>

<span class="sd">    SeeAlso:</span>
<span class="sd">        vt.index_to_boolmask numpy version</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m vtool.other --exec-index_to_boolmask</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from utool.util_list import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import utool as ut</span>
<span class="sd">        &gt;&gt;&gt; index_list = [0, 1, 4]</span>
<span class="sd">        &gt;&gt;&gt; maxval = 5</span>
<span class="sd">        &gt;&gt;&gt; mask = ut.index_to_boolmask(index_list, maxval)</span>
<span class="sd">        &gt;&gt;&gt; result = (&#39;mask = %s&#39; % (ut.repr2(mask, nl=0)))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        mask = [True, True, False, False, True]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">maxval</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">maxval</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">index_list</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">maxval</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">:</span>
        <span class="n">mask</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="n">mask</span>


<span class="c"># Aliases</span></div>
<span class="n">list_compress</span> <span class="o">=</span> <span class="n">compress</span>
<span class="n">list_ziptake</span> <span class="o">=</span> <span class="n">ziptake</span>
<span class="n">list_zipcompress</span> <span class="o">=</span> <span class="n">zipcompress</span>
<span class="n">list_where</span> <span class="o">=</span> <span class="n">where</span>
<span class="n">list_take</span> <span class="o">=</span> <span class="n">take</span>
<span class="n">list_argsort</span> <span class="o">=</span> <span class="n">argsort</span>


<span class="c">#def partition2(list_, idxs1, idxs2):</span>
<span class="c">#    list1_ = ut.take(list_, idxs1)</span>
<span class="c">#    list2_ = list(zip(ut.take(list_, idxs2)))</span>
<span class="c">#    partitioned_items = [list1_, list2_]</span>
<span class="c">#    return partitioned_items</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CommandLine:</span>
<span class="sd">        python -c &quot;import utool, utool.util_list; utool.doctest_funcs(utool.util_list, allexamples=True)&quot;</span>
<span class="sd">        python -c &quot;import utool, utool.util_list; utool.doctest_funcs(utool.util_list)&quot;</span>
<span class="sd">        python -m utool.util_list</span>
<span class="sd">        python -m utool.util_list --allexamples</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">multiprocessing</span>
    <span class="n">multiprocessing</span><span class="o">.</span><span class="n">freeze_support</span><span class="p">()</span>  <span class="c"># for win32</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>  <span class="c"># NOQA</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">doctest_funcs</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>


  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jon Crall.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>





    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.1.2.dev1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>





    <script type="text/javascript" src="../../_static/js/theme.js"></script>




  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>


</body>
</html>
